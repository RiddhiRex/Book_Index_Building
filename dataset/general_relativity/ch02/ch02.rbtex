<%
  require "./scripts/eruby_util.rb"
%>

<%
  chapter(
    '02',
    %q{Geometry of Flat Spacetime},
    'ch:flat'
  )
%>


The geometrical treatment of space, time, and gravity only requires as its basis the equivalence of
inertial and gravitational mass. Given this assumption, we can describe the trajectory of any
free-falling test particle as a geodesic.
Equivalence of inertial and gravitational mass holds for Newtonian gravity, so it is indeed possible
to redo Newtonian gravity as a theory of curved spacetime. This project was carried out by the French mathematician
Cartan.\index{Cartan!curved-spacetime theory of Newtonian gravity}\label{cartan-newtonian}
The geometry of the local reference frames is very simple.
The three space dimensions have an approximately Euclidean geometry, and the time dimension is
entirely separate from them. This is referred to as a Euclidean spacetime with 3+1 dimensions.
Although the outlook is
radically different from Newton's, all of the predictions of experimental results are the same.

The experiments in section \ref{sec:time-experiments} show, however, that there are real, experimentally verifiable
violations of Newton's laws. In Newtonian physics, time is supposed to flow at the same rate everywhere, which
we have found to be false. 
The flow of time is actually dependent on the observer's state of motion through space, which shows that the space
and time dimensions are intertwined somehow. 
The geometry of the local frames
in relativity therefore must not be as simple as Euclidean 3+1. Their actual geometry was implicit in Einstein's
1905 paper on special relativity, and had already been developed mathematically, without the
full physical interpretation, by Hendrik Lorentz. Lorentz's and Einstein's work were explicitly connected
by Minkowski in 1907, so a Lorentz frame is often referred to as a Minkowski frame.\index{Minkowski}

To describe this Lorentz geometry, we need to add
more structure on top of the axioms O1-O4 of ordered geometry, but it will not be the additional
Euclidean structure of E3-E4, it will be something different.
To see how to proceed, let's start by thinking about what bare minimum of
geometrical machinery is needed in order to set
up frames of reference.
<% marg(0) %>
<%
  fig(
    'lorentz-portrait',
    %q{Hendrik Antoon Lorentz (1853-1928)}
  )
%>
<% end_marg %>

<% begin_sec("Affine properties of Lorentz geometry",4,'affine-geometry') %>
<% begin_sec("Parallelism and measurement",nil,'parallelism-and-measurement') %>
We think of a frame of reference as a body of measurements or possible measurements to be made
by some observer. Ordered geometry lacks measure.
The following argument shows that merely by adding a notion of parallelism to our geometry, we
automatically gain a system of measurement.

We only expect Lorentz frames to be local, but we do need them
to be big enough to cover at least some amount of spacetime. If Betty does an E\"{o}tv\"{o}s experiment
by releasing a pencil and a lead ball side by side, she is essentially trying to release them at the same
event A, so that she can observe them later and determine whether their world-lines stay right on top
of one another at point B. That was all that was required for the E\"{o}tv\"{o}s experiment, but in order
to set up a Lorentz frame we need to start dealing with objects that are not right on top of one another.
Suppose we release two lead balls in two different locations, at rest relative to one another. This could be the first step toward
adding measurement to our geometry, since the balls mark two points in space that are separated by
a certain distance, like two marks on a ruler, or the goals at the ends of a soccer field.
Although the balls are separated by some finite distance, they are still close enough
together so that if there is a gravitational field in the area, it is very nearly the same in both
locations, and we expect the distance defined by the gap between them to stay the same.
Since they are both subject only to gravitational forces, their world-lines are by definition
straight lines (geodesics). The goal here is to end up with some kind of coordinate grid
defining a $(t,x)$ plane, and on such a grid, the two balls' world-lines are vertical lines.
If we release them at events P and Q, then observe them again later at R and S, PQRS should
form a rectangle on such a plot. In the figure, the irregularly spaced tick marks along the
edges of the rectangle are meant to suggest that although ordered geometry provides us with
a well-defined ordering along these lines, we have not yet constructed a complete system of measurement.

<% marg(80) %>
<%
  fig(
    'parallel-at-rest',
    %q{Objects are released at rest at spacetime events P and Q. They remain at rest, and their world-lines define a notion of parallelism.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'parallel-moving',
    %q{There is no well-defined angular measure in this geometry. In a different frame of reference, the angles are not right angles.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'parallel-no-simultaneity',
    %q{Simultaneity is not well defined. The constant-time lines PQ and RS from figure \figref{parallel-at-rest} are not constant-time lines when observed in
          a different frame of reference.}
  )
%>
<% end_marg %>

The depiction of PQSR as a rectangle, with right angles at its vertices, might lead us to believe that our geometry would
have something like the concept of angular measure referred to in Euclid's E4, equality of right angles.
But this is too naive even for the Euclidean 3+1 spacetime of Newton and Galileo.
Suppose we switch to a frame that is moving relative to the first one, so that the balls
are not at rest. In the Euclidean spacetime, time is absolute, so events P and Q
would remain simultaneous, and so would R and S; the
top and bottom edges PQ and RS would remain horizontal on the plot, but the balls' world-lines
PR and QS would become slanted. The result would be a parallelogram. Since observers in different
states of motion do not agree on what constitutes a right angle, the concept of angular measure
is clearly not going to be useful here. Similarly, if Euclid had observed that a right angle
drawn on a piece of paper no longer appeared to be a right angle when the paper was turned around,
he would never have decided that angular measure was important enough to be enshrined in E4.

In the context of relativity, where time is not absolute, there is not even any reason to believe that different observers
must agree on the simultaneity of PQ and RS. Our observation that time flows differently depending
on the observer's state of motion tells us specifically to expect this \emph{not} to happen when we
switch to a frame moving to the relative one. Thus in general we expect that PQRS will be distorted
into a form like the one shown in figure \figref{parallel-no-simultaneity}. We do expect, however, that it will
remain a parallelogram; a Lorentz frame is one in which the gravitational field, if any, is constant, so
the properties of spacetime are uniform, and by symmetry the new frame should still have PR=QS and PQ=RS.

With this motivation, we form the system of \emph{affine geometry}\index{affine geometry} by adding the following axioms
to set O1-O4.\footnote{The axioms are summarized for convenient reference in the back of the book on page
\pageref{affine-summary}. This formulation is essentially the one given by Penrose, \emph{The Road to Reality}, in section 14.1.}\label{affine-axioms}
The notation [PQRS] means that events P, Q, S, and R form a parallelogram, and is defined
as the statement that the lines determined by PQ and RS never meet at a point, and similarly for PR and QS.

\begin{itemize}\label{affine-axioms}
\item[A1] Constructibility of parallelograms: Given any P, Q, and R, there exists S such that [PQRS], and if P, Q, and R are distinct then S is unique.
\item[A2] Symmetric treatment of the sides of a parallelogram: If [PQRS], then [QRSP], [QPSR], and [PRQS].
\item[A3] Lines parallel to the same line are parallel to one another: If [ABCD] and [ABEF], then [CDEF].
\end{itemize}

The following theorem is a stronger version of Playfair's axiom E5, the interpretation being that affine geometry
describes a spacetime that is locally flat.

Theorem: Given any line $\ell$ and any point P not on the line, there exists a unique line through P that is parallel
to $\ell$.

This is stronger than E5, which only guarantees uniqueness, not existence.
Informally, the idea here is that A1 guarantees the existence of the parallel, and A3 makes it unique.\footnote{
Proof: Pick any two distinct points A and B on $\ell$, and construct the uniquely determined parallelogram [ABPQ] (axiom A1).
Points P and Q determine a line (axiom O1), and this line is parallel to $\ell$ (definition of the parallelogram).
To prove that this line is unique, we argue by contradiction. Suppose some other parallel $m$ to exist.
If $m$ crosses the infinite line BQ at some point Z, then both [ABPQ] and [ABPZ], so by A1, Q=Z, so the
$\ell$ and $m$ are the same. The only other possibility is that $m$ is parallel to BQ, but then the following
chain of parallelisms holds: PQ $\parallel$ AB $\parallel$ $m$ $\parallel$ BQ. By A3, lines parallel to another
line are parallel to each other, so PQ $\parallel$ BQ, but this is a contradiction, since they have Q in common.}

Although these new axioms do nothing more than to introduce the concept of parallelism lacking in ordered
geometry, it turns out that they also allow us to build up a concept of measurement. Let $\ell$ be
a line, and suppose we want to define a number system on this line that measures how far apart events are.
Depending on the type of line, this could be a measurement of time, of spatial distance, or a mixture of the
two. First we arbitrarily single out two distinct points on $\ell$ and label them 0 and 1. Next, pick some
auxiliary point $\zu{q}_0$ not lying on $\ell$. By A1, construct the parallelogram $01\zu{q}_0\zu{q}_1$.
Next construct $\zu{q}_01\zu{q}_12$. Continuing in this way, we have a scaffolding of parallelograms adjacent
to the line, determining an infinite lattice of points 1, 2, 3, \ldots on the line, which
represent the positive integers. Fractions can be defined in a similar way. For example, $\frac{1}{2}$ is defined
as the point such that when the initial lattice segment $0\frac{1}{2}$ is extended by the same construction, the next point
on the lattice is 1. 
<% marg(50) %>
<%
  fig(
    'lattice-construction',
    %q{Construction of an affine parameter.}
  )
%>
<% end_marg %>

The continuously varying variable constructed in this way is called an \emph{affine parameter}.\index{affine parameter}
The time measured by a free-falling clock is an example of an affine parameter, as is the distance measured
by the tick marks on a free-falling ruler. Since light rays travel along geodesics, the wave crests on a light wave
can even be used analogously to the ruler's tick marks.

\begin{eg}{Centroids}
The affine parameter can be used to define the centroid of a set of points. In the simplest
example, finding the centroid of two points, we simply bisect the line segment as described above in the
construction of the number  $\frac{1}{2}$. Similarly, the centroid of a triangle can be defined as the
intersection of its three medians, the lines joining each vertex to the midpoint of the opposite side.
\end{eg}
<% marg(10) %>
<%
  fig(
    'centroid',
    %q{Affine geometry gives a well-defined centroid for the triangle.}
  )
%>
<% end_marg %>

\begin{eg}{Conservation of momentum}
In nonrelativistic mechanics, the concept of the center of mass is closely related to the law of conservation
of momentum. For example, a logically complete statement of the law is that
if a system of particles is not subjected to any external force, and we pick a frame in which its center
of mass is initially at rest, then its center of mass remains at rest in that frame. Since centroids 
are well defined in affine geometry, and Lorentz frames have affine properties,
we have grounds to hope that it might be possible to generalize the definition of
momentum relativistically so that the generalized version is conserved in a Lorentz frame. 
On the other hand, we don't expect to be able to define anything like a global Lorentz frame
for the entire universe, so there is no such natural expectation of being able to define
a global principle of conservation of momentum. This is an example of a general fact about relativity,
which is that conservation laws are difficult or impossible to formulate globally.
\end{eg}

Although the affine parameter gives us a system of measurement for free in a geometry
whose axioms do not even explicitly mention measurement, there are some restrictions:

\begin{itemize}
\item[] The affine parameter is defined only along straight lines, i.e., geodesics. Alice's clock defines an affine parameter,
but Betty's does not, since it is subject to nongravitational forces.
\item[] We cannot compare distances along two arbitrarily chosen lines, only along a single line or two parallel lines.
\item[] The affine parameter is arbitrary not only in the choice of its origin 0 (which is to be expected in
any case, since any frame of reference requires such an arbitrary choice) but also in the choice of scale.
For example, there is no fundamental way of deciding how fast to make a clock tick.
\end{itemize}

We will eventually want to lift some of these restrictions by adding to our kit a tool called a metric, which
allows us to define distances along arbitrary curves in space time, and to compare distances in different directions.
The affine parameter, however, will not be entirely superseded. In particular, we'll find that the metric
has a couple of properties that are not as nice as those of the affine parameter. The square of a metric
distance can be negative, and the metric distance measured along a light ray is precisely zero, which is
not very useful.

Self-check: By the construction of the affine parameter above, affine distances
on the same line are comparable. By another construction, verify the claim made above that this can be
extended to distances measured along two different parallel lines.
<% marg(0) %>
<%
  fig(
    'affine-area-lattice',
    %q{Example \ref{eg:affine-area-lattice}. The area of the viola can be determined by counting the
           parallelograms formed by the lattice. The area can be determined to any desired precision,
           by dividing the parallelograms into fractional parts that are as small as necessary.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'affine-area',
    %q{Example \ref{eg:affine-area}.}
  )
%>
<% end_marg %>

\begin{eg}{Area and volume}\label{eg:affine-area-lattice}\label{affine-area-and-volume}
It is possible to define area and volume in affine geometry. This is a little surprising,
since distances along different lines are not even comparable. However, we are already accustomed to multiplying
and dividing numbers that have different units (a concept that would have given Euclid conniptions), and the
situation in affine geometry is really no different. To define area, we extend the one-dimensional lattice
to two dimensions. Any planar figure can be superimposed on such a lattice, and dissected into parallelograms,
each of which has a standard area.
\end{eg}

\begin{eg}{Area on a graph of v versus t}\label{eg:affine-area}
If an object moves at a constant velocity v for time t, the distance it travels can be represented by the
area of a parallelogram in an affine plane with sides having lengths v and t. These two lengths are measured by affine parameters
along two different directions, so they are not comparable. For example, it is meaningless to ask whether 1 m/s is greater
than, less than, or equal to 1 s. If we were graphing velocity as a function of time on a conventional Cartesian graph,
the v and t axes would be perpendicular, but affine geometry has no notion of angular measure, so this is irrelevant here.
\end{eg}

Self-check: If multiplication is defined in terms of affine area, prove the commutative property $ab=ba$ and the
distributive rule $a(b+c)=ab+bc$ from axioms A1-A3.

<% end_sec %> % Parallelism and measurement

<% begin_sec("Vectors",nil,'affine-vectors') %>

<% begin_sec("Vectors distinguished from scalars") %>\label{vector-vs-scalar}\index{vector!defined}\index{scalar!defined}
We've been discussing subjects like the center of mass that in freshman mechanics would
be described in terms of vectors and scalars, the distinction being that vectors have
a direction in space and scalars don't. As we make the transition to relativity,
we are forced to refine this distinction. For example, we used to consider time as
a scalar, but the Hafele-Keating experiment shows that time is different in different
frames of reference, which isn't something that's supposed to happen with scalars
such as mass or temperature. In affine geometry, it doesn't make much sense to say that
a vector has a magnitude and direction, since non-parallel magnitudes aren't comparable,
and there is no system of angular measurement in which to describe a direction.

A better way of defining vectors and scalars is that scalars are absolute, vectors
relative. If I have three apples in a bowl, then all observers in all frames of
reference agree with me on the number three. But if my terrier pup pulls on the leash
with a certain force vector, that vector has to be defined in relation to other things.
It might be three times the strength of some force that we define as one newton, and 
in the same direction as the earth's magnetic field.

In general, measurement means comparing one thing to another. The number of apples in
the bowl isn't a measurement, it's a count.
<% end_sec %> % Vectors and scalars

<% begin_sec("Affine measurement of vectors") %>
Before even getting into the full system of affine geometry, let's consider the one-dimensional
example of a line of time.
We could use the hourly
emergence of a mechanical bird from a pendulum-driven cuckoo
clock to measure the rate at which the earth spins, but we could equally well take our planet's
rotation as the standard and use it to measure the frequency with which the bird pops out of the door.
Once we have two things to
compare against one another, measurement is reduced to counting (figure
\figref{lattice-construction}, p.~\pageref{fig:lattice-construction}).
Schematically, let's represent this measurement process with
the following notation, which is part of a system called called birdtracks:\index{birdtracks notation}%
\footnote{The system used in this book
follows the one defined by Cvitanovi\'{c}, which was based closely on a graphical
notation due to Penrose. For a more complete exposition, see the Wikipedia article
``Penrose graphical notation'' and Cvitanovi\'{c}'s 
online book at \url{birdtracks.eu}.}\index{birdtracks}\index{Cvitanovi\'{c}, Predrag}
\index{Penrose!graphical notation for tensors}\index{tensor!Penrose graphical notation}
\index{vector!Penrose graphical notation}
\begin{equation*}
  __birdscalarproduct(c,e) = 24
\end{equation*}
Here $c$ represents the cuckoo clock and $e$ the rotation of the earth.
Although the measurement relationship is nearly symmetric, the arrow has a direction, because,
for example, the measurement of the earth's rotational period in terms of the clock's frequency is
$__birdscalarproduct(c,e)=(24\ \zu{hr})(1\ \zu{hr}^{-1})=24$, but the clock's period in terms of the earth's frequency
is $__birdscalarproduct(e,c)=1/24$. We say that the relationship is
not symmetric but ``dual.'' By the way, it doesn't matter
how we arrange these diagrams on the page. The notations __birdscalarproduct(c,e)
and __birdflipscalarproduct(c,e) mean exactly the same thing, and expressions like this can even be drawn
vertically.

Suppose that $e$ is a displacement along some one-dimensional line of time, and we want to think of it as the
thing being measured. Then we expect that the measurement process represented by $c$
produces a real-valued result and is a linear function of $e$. Since the relationship
between $c$ and $e$ is dual, we expect that $c$ also belongs to some
vector space. For example, vector spaces allow multiplication by a scalar:
we could double the frequency of the cuckoo clock by making the bird
come out on the half hour as well as on the hour, forming $2c$. Measurement should
be a linear function of both vectors; we say it is ``bilinear.'' 
<% end_sec %>


<% begin_sec("Duality") %>\index{dual vector}\index{vector!dual}
The two vectors $c$ and $e$ have different units,
$\zu{hr}^{-1}$ and hr, and
inhabit two different one-dimensional vector spaces.
The ``flavor'' of the vector is represented by whether the arrow goes into
it or comes out. Just as we used notation like $\overrightarrow{v}$ in freshman physics to
tell vectors apart from scalars, we can employ arrows in the birdtracks
notation as part of the notation for
the vector, so that
instead of writing the two vectors as $c$ and $e$, we can notate them
as __birddualvec(c) and __birdvec(e). Performing a measurement is like plumbing.
We join the two ``pipes'' in __birddualvec(c)__birdvec(e) and simplify to
__birdscalarproduct(c,e).

A confusing and nonstandardized jungle of notation and terminology has grown up around these concepts. For now,
let's refer to a vector such as __birdvec(e), with the arrow coming in, simply as a ``vector,''
and the type like __birddualvec(c) as a ``dual vector.''
In the one-dimensional example of the earth and the cuckoo clock, the roles played by the two
vectors were completely equivalent, and it didn't matter which one we expressed as a vector
and which as a dual vector. Example \ref{eg:force-is-lower-index} shows that it is sometimes
more natural to take one quantity as a vector and another as a dual vector. Example
\ref{eg:systems-without-a-metric} shows that we sometimes have no choice at all as to which
is which.
<% end_sec %> % Duality

<% begin_sec("Scaling") %>\label{scaling-vectors-and-duals}
In birdtracks notation, a scalar is a quantity that has no external arrows at all. Since the
expression $__birdscalarproduct(c,e)=24$ has no external arrows, only internal ones, it represents
a scalar. This makes sense because it's a count, and a count is a scalar.

A convenient way of summarizing all of our categories of variables is by their behavior
when we convert units, i.e., when we rescale our space. If we switch our time unit from
hours to minutes, the number of apples in a bowl is unchanged, the earth's period of
rotation gets 60 times bigger, and the frequency of the cuckoo clock changes by a
factor of 1/60. In other words, a quantity $u$ under rescaling of coordinates
by a factor $\alpha$ becomes $\alpha^p u$, where the exponents $-1$, $0$, and $+1$
correspond to dual vectors, scalars, and vectors, respectively. We can therefore see that
these distinctions are of interest even in one dimension, contrary to what one would have
expected from the freshman-physics concept of a vector as something transforming in a certain
way under rotations.
<% end_sec %> % Scaling

<% begin_sec("Geometrical visualization") %>\label{visualize-vectors-and-duals}
In two dimensions, there are natural ways of visualizing the different vector spaces inhabited by
vectors and dual vectors.
We've already been describing a vector like __birdvec(e) as a displacement. Its vector space is the
space of such displacements.\footnote{In terms of the primitive notions used in the axiomatization
in section \ref{sec:affine-geometry}, a displacement could be described as
an equivalence class of segments such that
for any two segments in the class AB and CD, AB and CD form a parallelogram.}
A vector in the dual space such as __birddualvec(c)
can be visualized as a set of parallel, evenly spaced lines
on a topographic map, \subfigref{vector-measuring-covector}{2}, with an arrowhead to show which way is ``uphill.''
The act of measurement consists of counting how many of these
lines are crossed by a certain vector, \subfigref{vector-measuring-covector}{3}.
<% marg(50) %>
<%
  fig(
    'vector-measuring-covector',
    %q{1. A displacement vector. 2. A vector from the space dual to the space of displacements.
       3. Measurement is reduced to counting.
          The cuckoo clock chimes 24 times in one rotation of the earth.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'isotherms',
    %q{Constant-temperature curves for January in North America, at intervals of $4\degcunit$.
       The temperature gradient at a given point is a dual vector.}
  )
%>
<% end_marg %>
<% end_sec %> % Geometrical visualization


Given a scalar field $f$, its gradient $\operatorname{grad} f$ at any given point is a dual vector.
In birdtracks notation, we have to indicate this by writing it with an
outward-pointing arrow, $__birddualvec((\operatorname{grad} f))$. Because
gradients occur so frequently, we have a special shorthand for them, which is
simply a circle:
\begin{equation*}
  __birdgrad(f)
\end{equation*}
In the context of  spacetime with a metric and curvature, we'll see that the usual definition
of the gradient in terms of partial derivatives should be modified with correction terms to
form something called a covariant derivative. When we get to that point on p.~\pageref{nabla-birdtracks},
we'll commandeer the circle notation for that operation.\label{birdtracks-circle-not-covariant}

\begin{eg}{Force is a dual vector}\label{eg:force-is-lower-index}\index{force!is a dual vector}
The dot product $\der W=\vc{F}\cdot\der\vc{x}$ for computing mechanical work becomes,
in birdtracks notation,
\begin{equation*}
  \der W = __birdscalarproduct(F,\der x)\eqquad.
\end{equation*}
This shows that force is more naturally considered to be a dual vector rather than a vector.
The symmetry between vectors and dual vectors is broken by considering displacements like
__birdvec(\der x) to be vectors, and this asymmetry then spreads to other quantities such as force.

The same result can be obtained from Newton's second law; see example \ref{eg:momentum-is-lower-index}
on p.~\pageref{eg:momentum-is-lower-index}.
\end{eg}

\begin{eg}{Systems without a metric}\label{eg:systems-without-a-metric}
The freshman-mechanics way of thinking about vectors and scalar products contains the hidden assumption
that we have, besides affine measurement, an additional piece of measurement apparatus called the metric (section
\ref{sec:metric}, p.~\pageref{sec:metric}). Without yet having to formally define what we mean by
a metric, we can say roughly that it supplies the conveniences that we're used to having in the
Euclidean plane, but that are not present in affine geometry. In particular, it allows us to define
the notion that one vector is perpendicular to another vector, or that one dual vector is perpendicular
to another dual vector.

Let's start with an example where the hidden assumption is valid, and we \emph{do} have a metric. 
Let a billiard ball of unit mass be constrained by a diagonal wall to have $C\le 0$, where
$C=y-x$. 
The Lagrangian formalism just leads to the expected Newtonian expressions for the momenta
conjugate to $x$ and $y$, $p_x=\dot{x}$, $p_y=\dot{y}$, and these
form a dual vector $__birddualvec(p)$.
The force of constraint is $__birddualvec(F)=__birddualvec(\der p)/dt$.
Let $__birddualvec(w)=__birddualvec((\operatorname{grad}\: C))$
be the gradient of the constraint function. 
The vectors __birddualvec(F) and __birddualvec(w) both belong to the space of dual vectors, and they
are parallel to each other.
Since we do happen to have a metric in this example, it is also possible to say, as most people
would, that the force is perpendicular to the wall.
<% marg(65) %>
<%
  fig(
    'barbell',
    %q{There is no natural metric on the space $(\theta,\phi)$.}
  )
%>
<% end_marg %>

Now consider the example shown in figure \figref{barbell}.
The arm's weight is negligible compared to the unit mass of the gripped weight, and both the upper and
lower arm have unit length. Elbows don't bend backward, so we have a constraint
$C \le 0$, where $C=\theta-\phi$, and as before we can define
define a dual vector $__birddualvec(w)=__birddualvec((\operatorname{grad}\: C))$ that is parallel to the line of constraint
in the $(\theta,\phi)$ plane.
The conjugate momenta (which are actually angular momenta) turn out to be
$p_\theta=\dot{\theta}+\cos(\phi-\theta)\dot{\phi}$ and a similar expression for $p_\phi$.
As in the example of the billiard ball,
the force of constraint is parallel to __birddualvec(w).
There is no metric that naturally applies to the $(\theta,\phi)$ plane, so we have no
notion of perpendicularity, and it
doesn't make sense to say that __birddualvec(F) is perpendicular to the line of constraint. 

Finally we remark that since four-dimensional Galilean spacetime
lacks a metric (see p.~\pageref{no-galilean-metric}),
the distinction between vectors and dual vectors in Galilean relativity
is a real and physically important one. The only reason people were historically able
to ignore this distinction was that Galilean spacetime splits into independent time and
spatial parts, with the spatial part having a metric.
\end{eg}

\begin{eg}{No simultaneity without a metric}\label{eg:no-simult-without-metric}
We'll see in section \ref{sec:lorentz-geometry}
that one way of defining the distinction between Galilean and Lorentz geometry is
that in Lorentzian spacetime, simultaneity is observer-dependent.
Without a metric, there can be no notion of simultaneity at all, not even a frame-dependent one. In figure
\figref{no-affine-simultaneity}, the fact that the observer considers events
P and Q to be simultaneous is represented by the fact that the observer's
displacement vector __birdvec(o) is perpendicular to the displacement __birdvec(s)
from P to Q. In affine geometry, we can't express perpendicularity.
\end{eg}
<% marg(50) %>
<%
  fig(
    'no-affine-simultaneity',
    %q{The free-falling observer considers P and Q to be simultaneous.}
  )
%>
<% end_marg %>


<% begin_sec("Abstract index notation") %>\label{abstract-index-notation}
Expressions in birdtracks notation such as
\begin{equation*}
  __birdgrad(C)s
\end{equation*}
can be awkward to type on a computer, which is why we've already been occasionally resorting to
more linear notations such as $__birdscalarproduct((\operatorname{grad}C),s)$. As we encounter
more complicated birdtracks, the diagrams will sometimes look like complicated electrical schematics, and
the problem of generating them on a keyboard will get more acute.
There is in fact a systematic way of representing any such expression using only ordinary subscripts
and superscripts. This is called abstract index notation, and was introduced by Roger Penrose
at around the same time he invented birdtracks. For practical reasons, it was the abstract index
notation that caught on.\index{abstract index notation}
\index{birdtracks notation!equivalent to abstract index notation}
\index{abstract index notation!equivalent to birdtracks}
\index{abstract index notation}

The idea is as follows. Suppose we wanted to describe a complicated birdtrack
verbally, so that someone else could draw it. 
The diagram would be made up of various smaller parts, a typical one looking something
like the scalar product $__birdscalarproduct(u,v)$. The verbal instructions might be: ``We have
an object $u$ with an arrow coming out of it. For reference, let's label this arrow as $a$.
Now remember that other object $v$ I had you draw before? There was an arrow coming into
that one, which we also labeled $a$. Now connect up the two arrows labeled $a$.''

Shortening this lengthy description to its bare minimum, Penrose renders it like
this: $u_av^a$. Subscripts depict arrows coming out of a symbol (think of water flowing
from a tank out through a pipe below). Superscripts indicate arrows going in. When
the same letter is used as both a superscript and a subscript, the
two arrows are to be piped together.

Abstract index notation evolved out of an earlier one 
called the Einstein summation convention,\index{Einstein summation convention}
in which superscripts and subscripts referred to specific coordinates.
For example, we might take 0 to be the time coordinate, 1 to be $x$, and so on.
A symbol like $u_\gamma$ would then indicate a component of the dual vector $u$,
which could be its $x$ component if $\gamma$ took on the value 1. Repeated indices
were summed over. 

The advantage of the birdtrack and abstract index notations is that they are
coordinate-independent, so that an equation written in them is valid regardless
of the choice of coordinates. The Einstein and Penrose notations look very similar,
so for example if we want to take a general result expressed in Penrose notation
and apply it in a specific coordinate system, there is essentially no translation
required. In fact, the two notations look so similar that we need an explicit way
to tell which is which, so that we can tell whether or not a particular result
is coordinate-independent. We therefore use the convention that Latin indices
represent abstract indices, whereas Greek ones imply a specific coordinate system
and can take on numerical values, e.g., $\gamma=1$.
<% end_sec %> % Abstract index notation

<% end_sec %> % Vectors

<% end_sec %> % Affine properties of Lorentz geometry

<% begin_sec("Relativistic properties of Lorentz geometry") %>\label{sec:lorentz-geometry}

We now want to pin down the properties of the Lorentz geometry that are left unspecified by the affine treatment.
We need some further input from experiments in order to show us how to proceed.
We take the following as empirical facts about flat spacetime:\footnote{These facts are summarized
for convenience on page \pageref{lorentz-summary} in the back of the book.}\label{lorentz-geometry-postulates}

\begin{itemize}
\item[L1] \emph{Spacetime is homogeneous and isotropic.} No time or place has special properties that make it distinguishable from other points, nor is one
                  direction in space distinguishable from 
                  another.\footnote{For the experimental evidence on isotropy, see \url{http://www.edu-observatory.org/physics-faq/Relativity/SR/experiments.html#Tests_of_isotropy_of_space}.}
\item[L2] \emph{Inertial frames of reference exist.} These are frames in which particles move at constant velocity if not subject to any forces.
                  We can construct such a frame by using a particular particle, which is not subject to any forces, as a reference point.
\item[L3] \emph{Equivalence of inertial frames:} If a frame is in constant-velocity translational motion relative to an inertial frame, then it is also an inertial frame.
              No experiment can distinguish one preferred inertial frame from all the others.
\item[L4] \emph{Causality:} There exist events 1 and 2 such that $t_1<t_2$ in all frames. 
\item[L5] \emph{Relativity of time:} There exist events 1 and 2 and frames of reference
        $(t,x)$ and $(t',x')$ such that $t_1<t_2$, but $t'_1>t'_2$.
\end{itemize}

L4 makes it possible to have an event 1 that causes an event 2, with all observers agreeing on which
caused which. L5 is supported by the experimental evidence in section \ref{sec:time-experiments};
if L5 were false, then space and time could work as imagined by Galileo and Newton.

Define affine parameters $t$ and $x$ for time and position, and construct a $(t,x)$ plane. Axiom L1
guarantees that spacetime is flat, allowing us to do this; if spacetime had, for example, a curvature
like that of a sphere, then the axioms of affine geometry would fail, and
it would be impossible to lay out such a global grid of parallels. Although
affine geometry treats all directions symmetrically, we're going beyond the affine aspects of
the space, and $t$ does play a different role than $x$
here, as shown, for example, by L4 and L5.

In the $(t,x)$ plane, consider a rectangle with one corner at the origin O. We can imagine its right and left edges
as representing the world-lines of two objects that are both initially at rest in this frame;
they remain at rest (L2), so the right and left edges are parallel.

How do we know that this is a rectangle and not some other kind of parallelogram? In purely affine
geometry, there is no notion of perpendicularity, so this distinction is meaningless.
But implicit in the existence of inertial frames (L2) is the assumption that spacetime has
some additional structure that allows a particular observer to decide what events he considers
to be simultaneous (example \ref{eg:no-simult-without-metric}, p.~\pageref{eg:no-simult-without-metric}).
He then considers his own world-line, i.e., his $t$ axis, to be perpendicular to a proposed
$x$ axis if points on the $x$ axis are simultaneous to him.

We now define a second frame of reference such that the origins of the two frames coincide, but they
are in motion relative to one another with velocity $v$. The transformation $L$ from the first frame to
the second is referred to as a Lorentz boost
with velocity $v$.\index{boost}\index{Lorentz boost} $L$ depends on $v$.
By equivalence of inertial frames (L3), an observer in the new frame considers his own $t$ axis 
to be perpendicular to his own $x$, even though they don't look that way in 
figure \figref{lorentz-boosted-rectangle}. Thus, although we assume some notion of perpendicularity, we
do not assume that it looks the same as the Euclidean one.

By homogeneity of spacetime (L1), $L$ must be linear, so the original rectangle will be
transformed into a parallelogram in the new frame; this is also consistent with L3, which requires that the
world-lines on the right and left edges remain parallel. The left edge has inverse slope $v$.
By L5 (no simultaneity), the top and bottom edges are no longer horizontal.
<% marg(70) %>
<%
  fig(
    'lorentz-boosted-rectangle',
    %q{Two objects at rest have world-lines that define a rectangle. In a second frame of reference in motion
        relative to the first one, the rectangle becomes a parallelogram.}
  )
%>
<% end_marg %>

For simplicity, let the original rectangle have unit area. Then the area of the new parallelogram is 
still 1, by the following argument. Let the new area be $A$, which is a function of $v$.
By isotropy of spacetime (L1), $A(v)=A(-v)$.
Furthermore, the function $A(v)$ must have some universal form for all geometrical figures, not just
for a figure that is initially a particular rectangle; this follows because of our definition of affine area in terms
of a dissection by a two-dimensional lattice, which we can choose to be a lattice of squares.
Applying boosts $+v$ and $-v$ one after another results in a transformation back into our original
frame of reference, and since $A$ is universal for all shapes, it doesn't matter that the second
transformation starts from a parallelogram rather than a square. Scaling the area once by $A(v)$
and again by $A(-v)$ must therefore give back the original square with its original unit area,
$A(v)A(-v)=1$, and since $A(v)=A(-v)$, $A(v)=\pm1$ for any value of $v$. Since $A(0)=1$, we must
have $A(v)=1$ for all $v$. The argument is independent of the shape of the region, so we conclude
that all areas are preserved by Lorentz boosts.\label{spacetime-area} (See subsection \ref{subsec:spacetime-volume}
on p.~\pageref{subsec:spacetime-volume} for further interpretation of $A$.)

If we consider a boost by an infinitesimal velocity $\der v$, then the vanishing change in area comes
from the sum of the areas of the four infinitesimally thin slivers where the rectangle lies either
outside the parallelogram (call this negative area) or inside it (positive). (We don't worry about
what happens near the corners, because such effects are of order $\der v^2$.) In other words, area flows
around in the $x-t$ plane, and the flows in and out of the rectangle must cancel. Let $v$ be positive;
the flow at the sides of the rectangle is then to the right. The flows through the top and bottom
cannot be in opposite directions (one up, one down) while maintaining the parallelism of the opposite
sides, so we have the following three possible cases:
<%
  fig(
    'lorentz-boost-area-flow-cases',
    %q{%
      Flows of area: (I) a shear that preserves simultaneity, (II) a rotation, (III) upward flow at all edges.
    },
    {
      'width'=>'wide',
      'sidecaption'=>true
    }
  )
%>

\begin{itemize}
\item[I] There is no flow through the top and bottom. This case corresponds to Galilean relativity, in which the rectangle shears horizontally under a boost,
  and simultaneity is preserved, violating L5.
\item[II] Area flows downward at both the top and the bottom. The flow is clockwise at both the positive $t$ axis and the positive $x$ axis.
  This makes it plausible that the flow is clockwise everywhere in the
  $(t,x)$ plane, and the proof is straightforward.\footnote{Proof: By linearity of $L$, the flow is clockwise at the negative axes as well.
  Also by linearity, the handedness of the flow is the same at all points on a ray extending
  out from the origin in the direction $\theta$. If the flow were
  counterclockwise somewhere, then it would have to switch handedness twice in that quadrant, at $\theta_1$ and $\theta_2$. But by writing out
  the vector cross product $\vc{r}\times\der\vc{r}$, where $\der\vc{r}$ is the displacement caused by $L(\der v)$, we find that it
  depends on $\sin(2\theta+\delta)$, which does not oscillate rapidly enough to have two zeroes in the same quadrant.}
  As $v$ increases, a particular element of area flows continually clockwise.
  This violates L4, because two events with a cause and effect
  relationship could be time-reversed by a Lorentz boost.
\item[III] Area flows upward at both the top and the bottom.
\end{itemize}

Only case III is possible, and given case III, there must be at least one
point P in the first quadrant where area flows neither clockwise nor
counterclockwise.\footnote{This follows from the fact that, as shown in the preceding footnote, the handedness of the flow
depends only on $\theta$.}
The boost simply increases P's distance from
the origin by some factor.
By the linearity of the transformation, the entire line running through O and P is simply rescaled. This
special line's inverse slope, which has units of velocity, apparently has some special significance, so we give it a name,
$c$. We'll see later that $c$ is the maximum speed of cause and effect whose existence we inferred
in section \ref{sec:max-speed-of-cause-and-effect}. Any world-line with
a velocity equal to $c$ retains the same velocity as judged by moving observers, and by isotropy the same must
be true for $-c$.

For convenience, let's adopt time and space units in which $c=1$, and let the original rectangle be a unit square.
The upper right tip
of the parallelogram must slide along the line through the origin with slope $+1$, and similarly
the parallelogram's other diagonal must have a slope of $-1$. Since these diagonals bisected one
another on the original square, and since bisection is an affine property that is preserved when
we change frames of reference, the parallelogram must be equilateral.

We can now determine the complete form of the Lorentz transformation. Let unit square PQRS,
as described above, be transformed to parallelogram $\zu{P}'\zu{Q}'\zu{R}'\zu{S}'$ in the new coordinate system
$(x',t')$. Let the $t'$ coordinate of $\zu{R}'$ be $\gamma$, interpreted as the ratio between
the time elapsed on a clock moving from $\zu{P}'$ to $\zu{R}'$ and the corresponding time as measured by
a clock that is at rest in the $(x',t')$ frame. By the definition of $v$, $\zu{R}'$ has coordinates $(v\gamma,\gamma)$, and
the other geometrical facts established above place $\zu{Q}'$ symmetrically on
the other side of the diagonal, at $(\gamma,v\gamma)$. Computing the cross product of vectors
$\zu{P}'\zu{R}'$ and $\zu{P}'\zu{Q}'$, we find the area of $\zu{P}'\zu{Q}'\zu{R}'\zu{S}'$ to be $\gamma^2(1-v^2)$, and setting this equal
to 1 gives
\begin{equation*}
  \gamma = \frac{1}{\sqrt{1-v^2}}\eqquad.
\end{equation*}
<% marg(70) %>
<%
  fig(
    'lorentz-boosted-rectangle-quantitative',
    %q{Unit square PQRS is Lorentz-boosted to the parallelogram $\zu{P}'\zu{Q}'\zu{R}'\zu{S}'$.}
  )
%>
<% end_marg %>


Self-check: Interpret the dependence of $\gamma$ on the sign of $v$.

<%
  fig(
    'gammagraph',
    %q{The behavior of the $\gamma$ factor.},
    {
      'width'=>'wide',
      'sidecaption'=>true
    }
  )
%>

The result for the transformation $L$, a Lorentz boost along the $x$ axis with velocity $v$, is:
\begin{align*}
  t' &= \gamma t + v \gamma x \\
  x' &= v \gamma t + \gamma x
\end{align*}

The symmetry of $\zu{P}'\zu{Q}'\zu{R}'\zu{S}'$ with respect to reflection across the diagonal indicates that
the time and space dimensions are treated symmetrically, although they are not entirely
interchangeable as they would have been in case II.

A measuring rod, unlike a clock, sweeps out a two-dimensional strip on an $x-t$ graph.
As in Galilean relativity, the two observers disagree on the positions of events
at the two ends of their rods, but in addition they  disagree on the simultaneity of such events.
Calculation shows that a moving rod appears contracted by a factor $\gamma$.

In summary, a clock runs fastest according to an observer
who is at rest relative to the clock, and a measuring rod likewise appears longest in its own rest frame.\index{time dilation!kinematic}\index{length contraction}

The lack of a universal notion of simultaneity has a similarly symmetric interpretation. In prerelativistic
physics, points in space have no fixed identity. A brass plaque commemorating a Civil War battle is not
at the same location as the battle, according to an observer who perceives the Earth has having been hurtling
through space for the intervening centuries. By symmetry, points in time have no fixed identity either.

In everyday life, we don't notice relativistic effects like time dilation, so apparently $\gamma\approx1$,
and $v \ll 1$, i.e., the speed $c$ must be very large when expressed in meters per second. By setting $c$ equal
to 1, we have chosen a the distance unit that is extremely long in proportion to the time unit.
This is an example of the correspondence principle,\index{correspondence principle}
which states that when a new physical theory, such as relativity, replaces an old one, such as Galilean relativity, it must remain
``backward-compatible'' with all the experiments that verified the old theory; that is, it must agree with the old
theory in the appropriate limit. Despite my coyness, you probably know that the speed of light is also
equal to $c$. It is important to emphasize, however, that light plays no special role in relativity, nor was
it necessary to assume the constancy of the speed of light in order to derive the Lorentz transformation; we will
in fact prove on page \pageref{c-is-speed-of-light} that photons must travel at $c$, and on page
\pageref{c-is-speed-of-massless-particles} that this must be true for any massless particle.

On the other hand, Einstein did originally develop relativity based on a different set of assumptions than
our L1-L5. His treatment, given in his 1905 paper ``On the electrodynamics of moving bodies,''  is
reproduced on p.~\pageref{einstein-relativity}. It starts from the following two postulates:
\begin{itemize}
\item[P1] The principle of relativity: ``\ldots the phenomena of electrodynamics as well as of mechanics
possess no properties corresponding to the idea of absolute rest.''
\item[P2] ``\ldots light is
always propagated in empty space with a definite velocity $c$ which is
independent of the state of motion of the emitting body.''
\end{itemize}
Einstein's P1 is essentially the same as our L3 (equivalence of inertial frames). He implicitly assumes
something equivalent to our L1 (homogeneity and isotropy of spacetime). In his system, our L5 (relativity of time)
is a theorem proved from the axioms P1-P2, whereas in our system, his P2 is a theorem proved from the axioms L1-L5.
<% marg(-20) %>
<%
  fig(
    'lorentz-boost-diagonals',
    %q{Example \ref{eg:lorentz-boost-diagonals}. Flashes of light travel along $\zu{P}'\zu{T}'$ and $\zu{Q}'\zu{T}'$.
          The observer in this frame of reference judges them to have been emitted at different times, and to have
          traveled different distances. }
  )
%>
<% end_marg %>

\vfill

\begin{eg}{}\label{eg:lorentz-boost-diagonals}
Let the intersection of the parallelogram's two diagonals be T in the original (rest) frame, and $\zu{T}'$
in the Lorentz-boosted frame. An observer at T in the original frame simultaneously detects the passing by of the
two flashes of light emitted at $\zu{P}$ and $\zu{Q}$, and since she is positioned at the midpoint of the diagram
in space, she infers that $\zu{P}$ and $\zu{Q}$ were simultaneous. Since the arrival of both flashes of light
at the same point in spacetime is a concrete event, an observer in the Lorentz-boosted frame must agree on their
simultaneous arrival. (Simultaneity \emph{is} well defined as long as no spatial separation is involved.)
But the distances traveled by the two flashes in the boosted frame are unequal, and since the speed of light is
the same in all cases, the boosted observer infers that they were not emitted simultaneously.
\end{eg}

\begin{eg}{}
A different kind of symmetry is the symmetry between observers. If observer A says observer B's
time is slow, shouldn't B say that A's time is fast? This is what would happen if B took a pill that slowed
down all his thought processes: to him, the rest of the world would seem faster than normal. But this can't
be correct for Lorentz boosts, because it would introduce an asymmetry between observers. There is no
preferred, ``correct'' frame corresponding to the observer who didn't take a pill; either observer can
correctly consider himself to be the one who is at rest. It may seem paradoxical that each observer could
think that the other was the slow one, but the paradox evaporates when we consider the methods available
to A and B for resolving the controversy. They can either (1) send signals back and forth, or (2)
get together and compare clocks in person. Signaling doesn't establish one observer as correct and one as
incorrect, because as we'll see
in the following section, there is a limit to the speed of propagation of signals; either observer ends
up being able to explain the other observer's observations by taking into account the finite and
changing time required for signals to propagate. Meeting in person requires one or both observers
to accelerate, as in the original story of Alice and Betty, and then we are no longer dealing with
pure Lorentz frames, which are described by non-accelerating observers.
\end{eg}

\begin{eg}{Einstein's goof}\label{eg:einstein-goof}
Einstein's original 1905 paper on special relativity, reproduced on p.~\pageref{einstein-relativity},
contains a famous incorrect prediction, that ``a
spring-clock at the equator must go more slowly, by a very small
amount, than a precisely similar clock situated at one of the
poles under otherwise identical conditions'' (p.~\pageref{einstein-goof}). This was a
reasonable prediction at the time, but we now know that it was incorrect because it neglected
gravitational time dilation. 
In the description of the Hafele-Keating experiment using
atomic clocks aboard airplanes (p. \pageref{subsec:hafele-keating}), 
we saw that both gravity and motion had effects on the rate of flow of time.
On p.~\pageref{grav-redshift-by-ep} we found based on the equivalence principle that the gravitational
redshift of an electromagnetic wave is $\Delta E/E=\Delta\Phi$ (where $c=1$ and $\Phi$ is the gravitational
potential $gy$), and that this could also be interpreted
as a gravitational time dilation  $\Delta t/t=\Delta\Phi$.

The clock at the equator suffers a kinematic time dilation
that would tend to cause it to run more slowly than the one at the pole. However, the earth is not a sphere,
so the two clocks are at different distances from the earth's center, and the field they inhabit is also
not the simple field of a sphere. This suggests that there may be an additional gravitational effect
due to $\Delta\Phi\ne 0$. 
Expanding the Lorentz gamma factor in a Taylor series, we find that the kinematic effect amounts to
$\Delta t/t = \gamma-1\approx v^2/2$. The mismatch in rates between the two clocks is
\begin{equation*}
  \frac{\Delta t}{t} \approx \frac{1}{2}v^2 -\Delta\Phi\eqquad,
\end{equation*}
where $\Delta\Phi=\Phi_{\text{equator}}-\Phi_{\text{pole}}$, and a factor of $1/c^2$ on the right is suppressed
because $c=1$. But this expression for $\Delta t/t$ vanishes,
because the surface of the earth's oceans is in equilibrium, and therefore a mass of water $m$ can be
brought from the north pole to the equator, with the change in potential energy $-m\Delta\Phi$ being
exactly sufficient to supply the necessary kinetic energy $(1/2)mv^2$.
We therefore find that a change of latitude
should have no effect on the rate of a clock, provided that it remains at sea level.

This has been verified
experimentally by Alley et al.\footnote{C.O. Alley, et al., in NASA Goddard Space Flight Center, Proc. of the 13th
Ann. Precise Time and Time Interval (PTTI) Appl. and Planning Meeting, p. 687-724, 1981, available
online at \url{http://www.pttimeeting.org/archivemeetings/index9.html}} Alley's group flew atomic
clocks from Washington, DC to Thule, Greenland, left them there for four days, and brought them back.
The difference between the clocks that went to Greenland and other clocks that stayed in Washington
was $38\pm5$ ns, which was consistent with the $35\pm 2$ ns effect predicted purely based on kinematic
and gravitational time dilation while the planes were in the air. If Einstein's 1905 prediction had
been correct, then there would have been an additional difference of 224 ns due to the difference in latitude.

The perfect cancellation of kinematic and gravitational effects is not as fortuitous as it might seem; this
is discussed in example \ref{eg:einstein-goof-rot} on p.~\pageref{eg:einstein-goof-rot}.
\end{eg}

\begin{eg}{GPS}\label{eg:gps}
In the GPS system, as in example \ref{eg:einstein-goof},
both gravitational and kinematic time dilation must be considered.
Let's determine the directions and relative strengths of the two effects in the case of a GPS satellite.

A radio photon emitted by a GPS satellite gains energy as it falls to the earth's surface, so its energy
and frequency are increased by this effect. The observer on the ground, after accounting for all non-relativistic effects
such as Doppler shifts and the Sagnac effect (p. \pageref{sagnac}),\index{Sagnac effect!in GPS} would interpret the frequency shift by saying that time aboard
the satellite was flowing more quickly than on the ground.

However, the satellite is also moving at orbital speeds, so there is a Lorentz time dilation effect. According
to the observer on earth, this causes time aboard the satellite to flow more slowly than on the ground.

We can therefore see that the two effects are of opposite sign. Which is stronger?

For a satellite in low earth orbit, we would have $v^2/r=g$, where $r$ is only slightly greater than the radius of the earth.
The relative effect on the flow of time
is $\gamma-1\approx v^2/2 = gr/2$. The gravitational effect, approximating
$g$ as a constant, is $-gy$, where $y$ is the satellite's altitude above the earth. For such a satellite,
the gravitational effect is down by a factor of $2y/r$, so the Lorentz time dilation dominates.

GPS satellites, however, are not in low earth orbit. They orbit at an altitude of about 20,200 km, which is quite a bit
greater than the radius of the earth. We therefore expect the gravitational effect to dominate. To confirm this,
we need to generalize the equation $\Delta t/t=\Delta\Phi$ (with $c=1$) from example
\ref{eg:einstein-goof} to the case where $g$ is not a constant.\index{time dilation!gravitational!nonuniform field}
Integrating the equation $\der t/t = \der\Phi$, we find that the time dilation factor is equal to $e^{\Delta\Phi}$.
When $\Delta\Phi$ is small, $e^{\Delta\Phi}\approx 1+\Delta\Phi$, and we have a relative effect
equal to $\Delta\Phi$. The total effect for a GPS satellite is thus
(inserting factors of $c$ for calculation with SI units, and using positive signs for blueshifts)
\begin{equation*}
  \frac{1}{c^2}\left(+\Delta\Phi-\frac{v^2}{2}\right) = 5.2\times10^{-10} - 0.9\times10^{-10}\eqquad,
\end{equation*}
where the first term is gravitational and the second kinematic. A more detailed analysis includes various time-varying
effects, but this is the constant part. For this reason, the atomic clocks aboard the satellites are set to
a frequency of 10.22999999543 MHz before launching them into orbit; on the average, this is perceived on the
ground as 10.23 MHz. A more complete analysis of the general relativity involved in the GPS system can be found
in the review article by Ashby.\footnote{N. Ashby, ``Relativity in the Global Positioning System,'' \url{http://www.livingreviews.org/lrr-2003-1}}
% calc -e "ge=9.8 m/s2; re=6370 km; r=re+20200 km; gs=ge(re/r)^2; G=6.67 10^-11 N.m2/kg2; M=5.97 10^24 kg; Phie=-GM/re; Phis=-GM/r; DPhi=Phis-Phie; c=3 10^8 m/s; DPhi/c^2; .5gsr/c^2"
% calc -e "f=10.23; d=10.22999999543-f; d/f"
\end{eg}

Self-check: Suppose that positioning a clock at a certain distance from a certain planet produces a fractional
change $\delta$ in the rate at which time flows. In other words, the time dilation factor is $1+\delta$. Now suppose
that a second, identical planet is brought into the picture, at an equal distance from the clock. The clock is positioned
on the line joining the two planets' centers, so that the gravitational field it experiences is zero. Is the fractional
time dilation now approximately 0, or approximately $2\delta$? Why is this only an approximation?

<%
  fig(
    'cern-muon-storage-ring',
    %q{Apparatus used for the test of relativistic time dilation described in example \ref{eg:cern-muons}. 
       The prominent black and white blocks are large magnets surrounding a circular pipe
       with a vacuum inside. \linebreak (c) 1974 by CERN.
    },
    {
      'width'=>'wide',
      'sidecaption'=>true,
      'sidepos'=>'t'
    }
  )
%>

\pagebreak

\begin{eg}{Large time dilation}\label{eg:cern-muons}
The time dilation effect in the Hafele-Keating experiment was very small. If we want to see a large time dilation
effect, we can't do it with something the size of the atomic clocks they used; the kinetic energy would be
greater than the total megatonnage of all the world's nuclear arsenals. We can, however, accelerate subatomic particles
to speeds at which $\gamma$ is large. An early, low-precision experiment of this kind was
performed by Rossi and Hall in 1941, using naturally occurring cosmic rays. Figure \figref{cern-muon-storage-ring} shows
a 1974 experiment\footnote{Bailey at al., Nucl. Phys. B150(1979) 1}
of a similar type which verified the time dilation predicted by relativity to a precision of about
one part per thousand.

Muons were produced by an
accelerator at CERN, near Geneva. A muon is essentially a heavier version
of the electron. Muons undergo radioactive decay,
lasting an average of only 2.197 $\mu\sunit$ before they evaporate into an electron and two neutrinos.
The 1974 experiment was actually built in order to measure the magnetic properties of muons, but it produced a high-precision
test of time dilation as a byproduct. Because muons have the same electric charge as electrons, they can be trapped using
magnetic fields. Muons were injected into the ring shown in figure \figref{cern-muon-storage-ring}, circling around it until they underwent radioactive decay.
At the speed at which these muons were traveling, they had $\gamma=29.33$, so on the average they lasted 29.33 times
longer than the normal lifetime. In other words, they were like tiny alarm clocks that self-destructed at a randomly
selected time. Figure \figref{cern-muon-graph} shows the number of radioactive decays counted, as a function of the
time elapsed after a given stream of muons was injected into the storage ring. The two dashed lines show the rates
of decay predicted with and without relativity. The relativistic line is the one that agrees with experiment.
\end{eg}
<% marg(120) %>
<%
  fig(
    'cern-muon-graph',
    %q{Muons accelerated to nearly $c$ undergo radioactive decay much more slowly than they would according to
       an observer at rest with respect to the muons. The first two data-points (unfilled circles) were subject
       to large systematic errors.}
  )
%>
<% end_marg %>

\begin{eg}{Time dilation in the Pound-Rebka experiment}\label{eg:pound-rebka-time-dilation}
In the description of the Pound-Rebka experiment on page \pageref{subsec:pound-rebka}, I postponed
the quantitative estimation of the frequency shift due to temperature. Classically, one expects only
a \emph{broadening} of the line, since the Doppler shift is proportional to $v_\parallel/c$, where
$v_\parallel$, the component of the emitting atom's velocity along the line of sight, averages to zero.
But relativity tells us to expect that if the emitting atom is moving, its time will flow more slowly,
so the frequency of the light it emits will also be systematically shifted downward. This frequency shift should increase
with temperature. In other words, the Pound-Rebka experiment was designed as a test of general relativity (the equivalence
principle), but this special-relativistic effect is just as strong as the relativistic one, and needed to be accounted
for carefully.
<% marg(63) %>
<%
  fig(
    'pound-rebka-temperature-effect',
    %q{The change in the frequency of x-ray photons emitted by $^{57}\zu{Fe}$ as a function of temperature, drawn after Pound And Rebka (1960).
       Dots are experimental measurements. The solid curve is Pound and Rebka's theoretical calculation using the Debye theory of the lattice vibrations
       with a Debye temperature of 420 degrees C. The dashed line is one with the slope calculated in the text using a simplified treatment of the
       thermodynamics. There is an arbitrary vertical offset in the experimental data, as well as the theoretical curves.}
  )
%>
<% end_marg %>

In Pound and Rebka's paper describing their experiment,\footnote{Phys. Rev. Lett. 4 (1960) 337}
they refer to a preliminary measurement\footnote{Phys. Rev. Lett. 4 (1960) 274}
in which they carefully measured this effect, showed that it was consistent with theory,
and pointed out that a previous claim by Cranshaw et al. of having measured the gravitational
frequency shift was vitiated by their failure to control for the temperature dependence.

It turns out that the full Debye treatment of the lattice vibrations is not really necessary
near room temperature, so we'll simplify the thermodynamics. At absolute temperature $T$,
the mean translational kinetic energy of each iron nucleus is $(3/2)kT$. The velocity is much less
than $c(=1)$, so we can use the nonrelativistic expression for kinetic energy,
$K=(1/2)mv^2$, which gives a mean value for $v^2$ of $3kT/m$. In the limit of $v \ll 1$,
time dilation produces a change in frequency by a factor of $1/\gamma$, which differs from unity by approximately $-v^2/2$.
The relative time dilation is therefore $-3kT/2m$, or, in metric units, $-3kT/2mc^2$. The vertical scale in figure \figref{pound-rebka-temperature-effect} contains
an arbitrary offset, since Pound and Rebka's measurements were the best absolute measurements to date of the frequency.
The predicted slope of $-3k/2mc^2$, however, is not arbitrary. Plugging in 57 atomic mass units for $m$, we find
the slope to be $2.4\times10^{-15}$, which, as shown in the figure is an excellent approximation (off by only
10\%) near room temperature.
% calc -e "m=1.66 10^-24 g * 57; c=3 10^8 m/s; k=1.381 10^-23 J; 3k/(2mc^2)"
%    2.43253716620867*10^-15

\end{eg}

<% begin_sec("Geodesics and stationary action") %>\index{geodesic!stationary action}\index{action}\index{stationary action}
One way of characterizing geodesics in spacetime is by using an action principle. This is similar
to characterizing a geodesic in Euclidean space as a line of minimum length between two points.
For a timelike geodesic from event P to event Q, we have a proper time $\tau$. In Lorentz spacetime,
this proper time is greater than it would have been for any non-geodesic motion from P to Q.
In curved spacetime, we must weaken this statement somewhat. The proper time may not be a global
maximum, but it is stationary. Stationarity means that if we vary the curve by some small amount, not moving any part of
it by a coordinate distance greater than $\epsilon$, then the change in
$\tau$ is of order $\epsilon^2$.

For spacelike geodesics in Lorentz spacetime, the proper length is stationary, but small deformations of the
curve can either increase or decrease the proper length. The stationary action approach does not work well
for lightlike geodesics.
<% end_sec %>

<% end_sec %>

<% begin_sec("The light cone",4) %>

Given an event P, we can now classify all the causal relationships in which P can participate.
In Newtonian physics, these relationships fell into two classes: P could potentially cause any event
that lay in its future, and could have been caused by any event in its past.
In a Lorentz spacetime, we have a trichotomy rather than a dichotomy. There is a third class
of events that are too far away from P in space, and too close in time, to allow any cause and effect
relationship, since causality's maximum velocity is $c$. Since we're working in units in which $c=1$,
the boundary of this set is formed by the lines with slope $\pm1$ on a $(t,x)$ plot. This is referred
to as the light cone,\index{light cone} and in the generalization from 1+1 to 3+1 dimensions, it literally
becomes a (four-dimensional) cone. The terminology comes from the fact that light happens to travel at $c$,
the maximum speed of cause and effect. If we make a cut through the cone defined by a surface of constant time
in P's future, the resulting section is a sphere (analogous to the circle formed by cutting a three-dimensional
cone), and this sphere is interpreted as the set of events on which P could have had a causal effect by
radiating a light pulse outward in all directions.
<% marg(100) %>
<%
  fig(
    'lightcone',
    %q{The light cone in 2+1 dimensions.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'light-cone-compared-to-circle',
    %q{The circle plays a privileged role in Euclidean geometry. When rotated, it stays the same. The pie slice
                  is not invariant as the circle is. A similar privileged place is occupied by the light
                  cone in Lorentz geometry. Under a Lorentz boost, the spacetime parallelograms change,
                  but the light cone doesn't.}
  )
%>
<% end_marg %>

Events lying inside one another's light cones are said to have a timelike relationship. Events outside each
other's light cones are spacelike in relation to one another, and in the case where they lie on the surfaces
of each other's light cones the term is lightlike.\index{spacelike}\index{timelike}\index{lightlike}

The light cone plays the same role in the Lorentz geometry that the circle plays in Euclidean geometry.
The truth or falsehood of propositions in Euclidean geometry remains the same regardless of how we rotate
the figures, and this is expressed by Euclid's E3 asserting the existence of circles, which remain
invariant under rotation. Similarly, Lorentz boosts preserve light cones and truth of propositions
in a Lorentz frame.

Self-check: Under what circumstances is the time-ordering of events P and Q preserved under a Lorentz boost?

In a uniform Lorentz spacetime, all the
light cones line up like soldiers with their axes parallel with one another. When gravity is present, however,
this uniformity is disturbed in the vicinity of the masses that constitute the sources.
The light cones lying near the sources tip toward the sources. Superimposed on top of this
gravitational tipping together, recent observations have demonstrated a systematic tipping-apart
effect which becomes significant on cosmological distance scales. The parameter $\Lambda$ that sets
the strength of this effect is known as the cosmological constant.\index{cosmological constant}
The cosmological constant is not related to the presence of any sources (such as negative masses),
and can be interpreted instead as a tendency for space to expand over time on its own initiative.
In the present era, the cosmological constant has overpowered the gravitation of the universe's
mass, causing the expansion of the universe to accelerate.

Self-check: In the bottom panel of figure \figref{tipping-light-cones}, can an observer look at the
properties of the spacetime in her immediate vicinity and tell how much her light cones are tipping,
and in which direction? Compare with figure \figref{local-lorentz-frames} on page \pageref{fig:local-lorentz-frames}.
<% marg(30) %>
<%
  fig(
    'tipping-light-cones',
    %q{Light cones tip over for two reasons in general relativity: because of the presence of masses, which
             have gravitational fields, and because of the cosmological constant. The time and distance
             scales in the bottom figure are many orders of magnitude greater than those in the top.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'bucket-and-black-hole',
    %q{Example \ref{eg:newtonian-black-hole}. Matter is lifted out of a Newtonian black hole with a bucket. The dashed line represents the point
            at which the escape velocity equals the speed of light.}
  )
%>
<% end_marg %>

\begin{eg}{A Newtonian black hole}\label{eg:newtonian-black-hole}\index{black hole!Newtonian}
In the case of a black hole, the light cone tips over so far that the entire future timelike
region lies within the black hole. If an observer is present at such an event, then that observer's
entire potential future lies within the black hole, not outside it.
By expanding on the logical consequences of this statement, we arrive at an example of
relativity's proper interpretation as a theory of causality, not a theory of objects exerting forces on one another
as in Newton's vision of action at a distance, or Lorentz's original ether-drag interpretation of the factor $\gamma$,
in which length contraction arose from a physical strain imposed on the atoms composing a physical body.

Imagine a black hole from a Newtonian point of view, as proposed in 1783 by
geologist John Michell. Setting the escape velocity equal to the speed of
light, we find that this will occur for any gravitating spherical body compact enough to have $M/r>c^2/2G$.
(A fully relativistic argument, as given in section \ref{sec:schwarzschild}, agrees on $M/r \propto c^2/G$, which is fixed by units. The correct unitless factor depends
on the definition of $r$, which is flexible in general relativity.)
A flash of light emitted from the surface of such a Newtonian black hole would fall back down like water from
a fountain, but it would nevertheless be possible for physical objects to escape, e.g., if they were lifted
out in a bucket dangling from a cable. If the cable is to support its own weight, it must have a tensile strength per unit density of at least
$c^2/2$, which is about ten orders of magnitude greater than that of carbon nanotube fibers. (The factor of $1/2$ is not to be
taken seriously, since it comes from a nonrelativistic calculation.)

The cause-and-effect interpretation of relativity tells
us that this Newtonian picture is incorrect. A physical object that approaches to within a distance $r$ of a concentration of
mass $M$, with $M/r$ sufficiently large, has no causal future lying at larger values of $r$. The conclusion
is that there is a limit on the tensile strength of any substance, imposed purely by general relativity, and we
can state this limit without having to know anything about the physical nature of the interatomic forces.
A more complete treatment of the tension in the rope is given in example \ref{eg:rope-in-sch}
on p.~\pageref{eg:rope-in-sch}.
Cf. also homework problem \ref{hw:speed-of-sound} and section \ref{sec:carousel}, as well as some references given in
the remark following problem \ref{hw:speed-of-sound}.
\end{eg}

<% begin_sec("Velocity addition") %>\label{sec:velocity-addition}\index{velocity addition}
In classical physics, velocities add in relative motion. For example, if a boat moves relative to
a river, and the river moves relative to the land, then the boat's velocity relative to the land
is found by vector addition. This linear behavior cannot hold relativistically. For example,
if a spaceship is moving at $0.60c$ relative to the earth, and it launches a probe at $0.60c$
relative to itself, we can't have the probe moving at $1.20c$ relative to the earth, because
this would be greater than the maximum speed of cause and effect, $c$. To see how to add velocities
relativistically, we start by rewriting the Lorentz transformation as the matrix
\begin{equation*}
  \left(
  \begin{array}{cc}
    \cosh\eta  & \sinh\eta \\
    \sinh\eta & \cosh\eta
  \end{array}
  \right)
\eqquad,
\end{equation*}
where $\eta=\tanh^{-1} v$ is called the \emph{rapidity}.\index{rapidity}
We are guaranteed that the matrix can be written in this form, because its area-preserving
property says that the determinant equals 1, and $\cosh^2\eta-\sinh^2\eta=1$ is an identity
of the hyperbolic trig functions. It is now straightforward to verify that multiplication
of two matrices of this form gives a third matrix that is also of this form, with $\eta=\eta_1+\eta_2$.
In other words, rapidities add linearly; velocities don't. In the example of the spaceship and the
probe, the rapidities add as $\tanh^{-1}.60+\tanh^{-1}.60=.693+.693=1.386$, giving the probe a velocity of
$\tanh 1.386=0.88$ relative to the earth. Any number of velocities can be added in this way, $\eta_1+\eta_2+\ldots+\eta_n$.
<% marg(80) %>
<%
  fig(
    'rapidity',
    %q{The rapidity, $\eta=\tanh^{-1} v$, as a function of $v$.}
  )
%>
<% end_marg %>

Self-check: Interpret the asymptotes of the graph in figure \figref{rapidity}.

\begin{eg}{Bell's spaceship paradox}\label{eg:bell-spaceship-paradox}\index{spaceship paradox}\index{Bell, John!spaceship paradox}
A difficult philosophical question is whether the time dilation and length contractions predicted by relativity
are ``real.'' This depends, of course, on what one means by ``real.'' They are frame-dependent, i.e., observers
in different frames of reference disagree about them. But this doesn't tell us much about their reality, since
velocities are frame-dependent in Newtonian mechanics, but nobody worries about whether velocities are real.
John Bell\index{Bell, John} (1928-1990) proposed the following thought experiment to physicists in the CERN cafeteria, and
found that nearly all of them got it wrong. He took this as evidence that their intuitions had been misguided by
the standard way of approaching this question of the reality of Lorentz contractions.

Let spaceships A and B accelerate as shown in figure \figref{bell-spaceship-paradox} along a straight line.
Observer C does not accelerate. The accelerations, as judged by C, are constant, and equal for the two ships.
Each ship is equipped with a yard-arm, and a thread is tied between the two arms. Does the thread break, due
to Lorentz contraction? (We assume that the acceleration is gentle enough that the thread does not break simply
because of its own inertia.)
<% marg(50) %>
<%
  fig(
    'bell-spaceship-paradox',
    %q{Example \ref{eg:bell-spaceship-paradox}.}
  )
%>
<% end_marg %>

The popular answer in the CERN cafeteria was that the thread would not break, the reasoning being that
Lorentz contraction is a frame-dependent effect, and no such contraction would be observed in A and B's frame.
The ships maintain a constant distance from one another, so C merely disagrees
with A and B about the length of the thread, as well as other lengths like the lengths of the spaceships.

The error in this reasoning is that the accelerations of A and B were specified to be equal and constant in C's frame,
not in A and B's. Bell's interpretation is that the frame-dependence is a distraction, that Lorentz contraction
is in some sense a real effect, and that it is therefore immediately clear that the thread must break, without
even having to bother going into any other frame.
To convince his peers in the cafeteria, however, Bell presumably needed to satisfy them as to the specific
errors in their reasoning, and this requires that we consider the frame-dependence explicitly.

We can first see that it is impossible, in general, for different observers to agree about what is meant by
constant acceleration. Suppose that A and B agree with C about the constancy of their acceleration.
Then A and B experience a voyage in which the rapidities of the stars around them (and of observer C) increase
linearly with time. As the rapidity approaches infinity, both C and the stars approach the speed of light. But since
A and C agree on the magnitude of their velocity relative to one another, this means that A's velocity
as measured by C must approach $c$, and this contradicts the premise that C observes constant
acceleration for both ships. Therefore A and B do not consider their own accelerations to be constant.

A and B do not agree with C about simultaneity, and since they also do not agree that their accelerations
are constant, they do not consider their own accelerations to be equal at a given moment of time. Therefore
the string changes its length, and this is consistent with Bell's original, simple answer, which did not require
comparing different frames of reference. To establish that the string comes under tension, rather than going
slack, we can apply the equivalence principle. By the equivalence
principle, any experiments done by A and B give the same results as if they were immersed in a gravitational
field. The leading ship B sees A as experiencing a gravitational time dilation. According to B, the slowpoke A isn't accelerating
as rapidly as it should, causing the string to break.

These ideas are closely related to the fact that general relativity does not admit any spacetime that
can be interpreted as a uniform gravitational field (see problem \ref{hw:uniform-field}, p.~\pageref{hw:uniform-field}).
\end{eg}


<% end_sec %>

<% begin_sec("Logic") %>
The trichotomous classification of causal relationships
has interesting logical implications. In classical Aristotelian logic,\index{logic!Aristotelian}\index{Aristotelian logic}\label{nonaristotelian}
every proposition is either true or false, but not both, and given propositions $p$ and $q$, we
can form propositions such as $p \wedge q$ (both $p$ and $q$) or $p \vee q$ (either $p$ or $q$).
Propositions about physical phenomena can only be verified by observation. Let $p$ be
the statement that a certain observation carried out at event P gives a certain result, and similarly for
$q$ at Q. If PQ is spacelike, then the truth or falsehood of $p \wedge q$ cannot be checked by physically
traveling to P and Q, because no observer would be able to attend both events. The truth-value of
$p \wedge q$ is unknown to any observer in the universe until a certain time, at which the relevant information has
been able to propagate back and forth. What if P and Q lie inside two different black holes? Then the truth-value
of $p \wedge q$ can never be determined by \emph{any} observer. Another example is the case in which P and Q
are separated by such a great distance that, due to the accelerating expansion of the universe, their future
light cones do not overlap.

We conclude that Aristotelian logic cannot be appropriately applied to
relativistic observation in this way. Some workers attempting to construct a quantum-mechanical theory of
gravity have suggested an even more radically observer-dependent logic, in which different observers may
contradict one another on the truth-value of a single proposition $p_1$, unless they agree in advance
on the list $p_2$, $p_3$, \ldots of all the other propositions that they intend to test as well. We'll
return to these questions on page \pageref{black-hole-complementarity}.
<% end_sec %>


<% end_sec %>

<% begin_sec("Experimental tests of Lorentz geometry") %>

We've already seen, in section \ref{sec:time-experiments}, a variety of evidence for the non-classical
behavior of spacetime. We're now in a position to discuss tests of relativity more quantitatively.
An up-to-date review of such tests is given by Mattingly.\footnote{\url{livingreviews.org/lrr-2005-5}}

One such test is that relativity requires the speed of light to be the same in all frames of reference,
for the following reasons.\label{c-is-speed-of-light} Compare with the speed of sound in air.
The speed of sound is not the same in all frames of reference, because the wave propagates
at a fixed speed relative to the air. An observer at who is moving relative to the air will measure
a different speed of sound. Light, on the other hand, isn't a vibration of any physical medium.
Maxwell's equations predict a definite value for the speed of light, regardless of the motion of the
source. This speed also can't be relative to any medium. If the speed of light isn't fixed relative to the
source, and isn't fixed relative to a medium, then it must be fixed relative to anything at all.
The only speed in relativity that is equal in all frames of reference is $c$, so light must propagate at $c$.
We will see on page \pageref{c-is-speed-of-massless-particles} that there is a deeper reason for this;
relativity requires that any massless particle propagate at $c$.
The requirement of $v=c$ for massless particles is so intimately hard-wired into the structure of
relativity that any violation of it, no matter how tiny, would be of great interest. Essentially,
such a violation would disprove Lorentz invariance, i.e., the invariance of the laws of physics
under Lorentz transformations. There are two types of tests we could do: (1) test whether photons
of all energies travel at the same speed, i.e., whether the vacuum is dispersive;
(2) test whether observers in all frames of reference measure the same speed of light.

<% begin_sec("Dispersion of the vacuum") %>\label{sec:lorentz-vacuum-dispersion}

Some candidate quantum-mechanical theories of gravity, such as loop quantum gravity,\index{loop quantum gravity}
predict a granular structure for spacetime at the Planck scale, $\sqrt{\hbar G/c^3}=10^{-35}$ m,
which one could imagine might lead to
deviations from $v=1$ that would become more and more significant for photons with wavelengths
getting closer and closer to that scale. Lorentz-invariance would then be an approximation valid
only at large scales. It turns out that the state of the art in loop quantum gravity is not
yet sufficient to say whether or not such an effect should exist.
<% marg(0) %>
<%
  fig(
    'gamma-ray-burst',
    %q{An artist's conception of a gamma-ray burst, resulting from a supernova explosion.}
  )
%>
<% end_marg %>

Presently the best experimental tests of the invariance of
the speed of light with respect to wavelength come from astronomical observations of gamma-ray bursts, which are sudden
outpourings of high-energy photons, believed to originate from a supernova explosion in another galaxy. One such observation,
in 2009,\footnote{\url{http://arxiv.org/abs/0908.1832}} collected photons from such a burst, with a duration of 2 seconds, indicating that the propagation
time of all the photons differed by no more than 2 seconds out of a total time in flight on the order
of ten billion years, or about one part in $10^{17}$! A single superlative photon in the burst had an energy of 31 GeV,
and its arrival within the same 2-second time window demonstrates Lorentz invariance over a vast range of photon energies,
contradicting heuristic estimates that had been made by some researchers in loop quantum gravity.

<% end_sec %>

<% begin_sec("Observer-independence of $c$") %>\label{sec:lorentz-michelson-morley}
The constancy of the speed of light for observers in all frames of reference
was originally detected in 1887 when
Michelson and Morley set up a clever apparatus to
measure any difference in the speed of light beams traveling
east-west and north-south. The motion of the earth around
the sun at 110,000 km/hour (about 0.01\% of the speed of
light) is to our west during the day. Michelson and Morley
believed that light was a vibration of a physical medium, the ether, so they expected that the
speed of light would be a fixed value relative to the ether.
As the earth moved through the ether, they thought they
would observe an effect on the velocity of light along an
east-west line. For instance, if they released a beam of
light in a westward direction during the day, they expected
that it would move away from them at less than the normal
speed because the earth was chasing it through the ether.
They were surprised when they found that the expected 0.01\%
change in the speed of light did not occur.\index{Michelson-Morley experiment}\index{ether}

<%
  fig(
    'michelson',
    %q{The Michelson-Morley experiment, shown in photographs, and drawings from the original 1887 paper.
       1. A simplified drawing of the apparatus. A beam of light from the source, s, is partially reflected and partially transmitted by the half-silvered
       mirror $\zu{h}_1$. The two half-intensity parts of the beam are reflected by the mirrors at a and b, reunited,
       and observed in the telescope, t. If the earth's surface was supposed to be moving through the ether,
       then the times taken by the two light waves to pass through the moving ether would be unequal, and
       the resulting time lag would be detectable by observing the interference between the waves when they were reunited.
       2. In the real apparatus, the light beams were reflected multiple times. The effective length of each arm was
       increased to 11 meters, which greatly improved its sensitivity to the small expected difference in the speed of light.
       3. In an earlier version of the experiment, they had run into problems with its ``extreme sensitiveness to vibration,''
       which was ``so great that it was impossible to see the interference fringes except at brief intervals \ldots even at
       two o'clock in the morning.'' They therefore mounted the whole thing on a massive stone floating in a pool of mercury,
       which also made it possible to rotate it easily. 4. A photo of the apparatus. Note that it is underground, in a room
       with solid brick walls.
    },
    {
      'width'=>'wide',
      'sidecaption'=>true,
      'sidepos'=>'t'
    }
  )
%>

Although the Michelson-Morley experiment was nearly two
dec\-ades in the past by the time Einstein published his first
paper on relativity in 1905, and Einstein did know about it,\footnote{J. van Dongen, http://arxiv.org/abs/0908.1545} 
it's unclear how much it influenced him. Michelson
and Morley themselves were uncertain about whether the result was to be trusted,
or whether systematic and random errors were masking a real effect from
the ether. There were a variety of competing theories, each of which could
claim some support from the shaky data. Some physicists believed
that the ether could be dragged along by matter moving through it, which inspired
variations on the experiment that were conducted on mountaintops in thin-walled buildings, (figure),
or with one arm of the apparatus out in the open, and the other surrounded by massive lead walls.
In the standard sanitized textbook version of the history of science, every scientist does his experiments
without any preconceived notions about the truth, and any disagreement is quickly settled by
a definitive experiment. In reality, this period of confusion about the Michelson-Morley
experiment lasted for four decades, and a few reputable skeptics,
including Miller, continued to believe that Einstein was wrong, and kept trying different variations
of the experiment as late as the 1920's. Most of the remaining doubters were convinced
by an extremely precise version of the experiment performed by Joos in 1930, although you can still
find kooks on the internet who insist  that Miller was right, and that there was a vast conspiracy to
cover up his results.
<%
  fig(
    'miller',
    %q{
       Dayton Miller thought that the result of the Michelson-Morley experiment
       could be explained because the ether had been pulled along by the dirt, and the walls of the laboratory. This motivated him
       to carry out a series of experiments at the top of Mount Wilson, in a building with thin walls. 
    },
    {
      'width'=>'wide',
      'sidecaption'=>false
    }
  )
%>


Before Einstein, some physicists who did believe the negative result of the Michelson-Morley experiment came up with
explanations that preserved the ether. In the period from 1889 to 1895, both Lorentz and George FitzGerald
suggested that the negative result of the Michelson-Morley
experiment could be explained if the earth, and every physical
object on its surface, was contracted slightly by the strain
of the earth's motion through the ether. Thus although Lorentz developed all the mathematics of Lorentz
frames, and got them named after himself, he got the interpretation wrong.
<%
  fig(
    'chung-g',
    %q{
       The results of the measurement of $g$ by Chung et al., section \ref{sec:chung}. The experiment was done on the Stanford University campus, surrounded
       by the Pacific ocean and San Francisco Bay, so it was subject to varying gravitational from both astronomical bodies and the rising and
       falling ocean tides. Once both of these effects are subtracted out of the data, there is no Lorentz-violating variation in $g$
       due to the earth's motion through space. Note that the data are broken up into three periods, with gaps of three months and four
       years separating them. (c) APS, used under the U.S. fair use exception to copyright.
    },
    {
      'width'=>'wide',
      'sidecaption'=>true
    }
  )
%>

<% end_sec %>

<% begin_sec("Lorentz violation by gravitational forces") %>\label{sec:chung}
The tests described in sections \ref{sec:lorentz-vacuum-dispersion} and \ref{sec:lorentz-michelson-morley} both
involve the behavior of light, i.e., they test whether or not electromagnetism really has the exact Lorentz-invariant
behavior contained implicitly in Maxwell's equations. In the jargon of the field, they test Lorentz invariance
in the ``photon sector.'' Since relativity is a theory of gravity, it is natural to ask whether the Lorentz invariance
holds for gravitational forces as well as electromagnetic ones. If Lorentz invariance is violated by gravity, then
the strength of gravitational forces might depend on the observer's motion through space, relative to some fixed
reference frame analogous to that of the ether. Historically, gravitational Lorentz violations have been much more difficult to
test, since gravitational forces are so weak, and the first high-precision data were obtained by Nordtvedt and Will in 1957,
70 years after Michelson and Morley. Nordtvedt and Will measured the strength of the earth's gravitational field as a function
of time, and found that it did not vary on a 24-hour cycle with the earth's rotation, once tidal effects had been accounted for.
Further constraints come from data on the moon's orbit obtained by reflecting laser beams from a mirror left behind by the
Apollo astronauts.
<% marg(0) %>
<%
  fig(
    'chung-interferometer',
    %q{The matter interferometer used by Chung et al. Each atom's wavefunction is split into two parts, which travel
       along two different paths (solid and dashed lines).}
  )
%>
<% end_marg %>

A recent high-precision laboratory experiment was done in 2009 by Chung et al.\footnote{\url{arxiv.org/abs/0905.1929}} They constructed
an interferometer in a vertical plane that is conceptually similar to a Michelson interferometer, except that
it uses cesium atoms rather than photons. That is, the light waves of the Michelson-Morley experiment are replaced
by quantum-mechanical matter waves. The roles of the half-silvered and fully silvered mirrors are filled by lasers, which kick
the atoms electromagnetically. Each atom's wavefunction is split into two parts, which travel by two different paths through spacetime, eventually
reuniting and interfering. The result is a measurement of $g$ to about one part per billion. The results, shown in figure
\figref{chung-g}, put a strict limit on violations of Lorentz geometry by gravity.

<% end_sec %>

<% end_sec %> % exptl tests

<% begin_sec("Three spatial dimensions") %>
New and nontrivial phenomena arise when we generalize from 1+1 dimensions to 3+1.
<% begin_sec("Lorentz boosts in three dimensions") %>\label{lorentz-three-dim}
How does a Lorentz boost along one axis, say $x$, affect the other two spatial coordinates $y$ and $z$?

First, we can rule out the possibility that such a transformation could have various terms such as
$t'=\ldots+(\ldots)y+\ldots$. For example, if the $t$ coefficient was positive for $v>0$, then the laws of
physics would be different from the laws that applied in a universe where the $y$ or $t$ axis was inverted,
but this would violate parity or time-reversal symmetry. This establishes that observers in the two frames
agree on the directions of the $y$ and $z$ axes and on simultaneity along those axes when they coincide.

Now suppose that two observers, in motion relative to one another along the $x$ axis, each carry
a stick, represented by line segments AB and CD, oriented along the $y$ axis, such that the bases of
the sticks A and C coincide at some time. Due to the vanishing of the types of terms in the transformation
referred to above, they agree that B and D are collinear with A (and C) at this time. Then by O3 and O4, either
B lies between A and D, D lies between A and B, or B=D. That is, they must agree whether the sticks are
equal in length or, if not, then on whose is longer. This would violate L1, isotropy of space,
since it would distinguish $+x$ from $-x$.

Another simple way to obtain this result is as follows. We have
already proved that area in the $(t,x)$ plane is preserved. The same proof applies to volume in the spaces
$(t,x,y)$ and $(t,x,z)$, hence lengths in the $y$ and $z$ directions are preserved. (The proof does \emph{not} apply to
volume in, e.g., $(x,y,z)$ space, because the $x$ transformation depends on $t$, and therefore if we are given
a region in $(x,y,z)$, we do not have enough information to say how it will change under a Lorentz boost.)

The complete form of the transformation $L(v\hat{\vc{x}})$, a Lorentz boost along the $x$ axis with velocity $v$, is therefore:
\begin{align*}
  t' &= \gamma t + v \gamma x \\
  x' &= v \gamma t + \gamma x \\
  y' &= y \\
  z' &= z
\end{align*}
<% marg(80) %>
<%
  fig(
    'boosts-tangling',
    %q{A boost along $x$ followed by a boost along $y$ results in tangling up of the $x$ and $y$ coordinates,
        so the result is not just a boost but a boost plus a rotation.}
  )
%>
<% end_marg %>


Based on the trivial nature of this generalization, it might seem as though no qualitatively new considerations
would arise in 3+1 dimensions as compared with 1+1.  To see that this is not the case, consider figure \figref{boosts-tangling}.
A boost along the $x$ axis tangles up the $x$ and $t$ coordinates. A $y$-boost mingles $y$ and $t$. Therefore
consecutive boosts along $x$ and $y$ can cause $x$ and $y$ to mix. The result, as we'll see in more detail below,
is that two consecutive boosts along non-collinear axes are not equivalent to a single boost; they are equivalent
to a boost plus a spatial rotation. The remainder of this section discusses this effect, known as Thomas precession,
in more detail; it can be omitted on a first reading.\index{Thomas precession}

Self-check: Apply similar reasoning to a Galilean boost.

<% end_sec %> % Lorentz boosts in three dimensions

<% begin_sec("Gyroscopes and the equivalence principle") %>

To see how this mathematical fact would play out as a physical effect, we need to consider how to make a physical manifestation of
the concept of a direction in space.

\label{sagnac}
In two space dimensions, we can construct a ring laser,\index{ring laser} \subfigref{photon-in-cavity-and-gyroscope}{1},
which in its simplest incarnation is a closed loop of optical fiber with a bidirectional laser
inserted in one place. Coherent light traverses the loop simultaneously in both directions, interfering
in a beat pattern, which can be observed by sampling the light at some point along the loop's
circumference. If the loop is rotated in its own plane, the interference pattern is altered,
because the beam-sampling device is in a different place, and the path lengths traveled by the
two beams has been altered. This phase shift is called the Sagnac effect,\index{Sagnac effect!defined}
after M. Georges Sagnac, who observed the effect in 1913 and interpreted it, incorrectly, as evidence for the existence
of the aether.\footnote{Comptes rendus de l'Acad\'{e}mie des science 157 (1913) 708}
% translation in Rizzi and Ruggiero anthology
The loop senses its own angular velocity relative to an inertial reference frame.
If we transport the loop while always carefully adjusting its orientation so as to prevent
phase shifts, then its orientation has been preserved. 
The atomic clocks used in the Hafele-Keating atomic-clock experiment\index{Hafele-Keating experiment}\index{atomic clocks}
described
on page \pageref{subsec:hafele-keating} were subject to the Sagnac effect.
<% marg(100) %>
<%
  fig(
    'photon-in-cavity-and-gyroscope',
    %q{Inertial devices for maintaining a direction in space: 1. A ring laser. 2. The photon in a perfectly reflective spherical cavity.
          3. A gyroscope.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'ring-laser-gyro',
    %q{A ring laser gyroscope built for use in inertial guidance of aircraft.}
  )
%>
<% end_marg %>

In three spatial dimensions, we could build a spherical cavity with
a reflective inner surface, and release a photon inside, \subfigref{photon-in-cavity-and-gyroscope}{2}.

\label{types-of-gyroscopes}
In reality, the photon-in-a-cavity is not very practical. The photon would eventually be
absorbed or scattered, and it would also be difficult to accurately initialize the device and read it out later. A more practical
tool is a gyroscope.  For example, one of the classic tests of general relativity is the
2007 Gravity Probe B\index{Gravity Probe B} experiment (discussed in detail on pages
\pageref{sec:geodetic-effect-estimate} and \pageref{sec:geodetic-effect-exact}), in which
four gyroscopes aboard a satellite were observed to precess due to special- and general-relativistic
effects.

The gyroscope, however, is not so obviously a literal implementation of our basic concept of a direction. How, then,
can we be sure that its behavior is equivalent to that of the photon-in-a-cavity? We could, for example,
carry out a complete mathematical development of the angular momentum vector in relativity.\footnote{This is done,
for example, in Misner, Thorne, and Wheeler, \emph{Gravitation}, pp. 157-159.} The equivalence principle, however,
allows us to bypass such technical details. Suppose that we seal the two devices inside black boxes, with identical
external control panels for initializing them and reading them out. We initialize them identically, and then
transport them along side-by-side world-lines. Nonrelativistically, both the mechanical gyroscope and the photon-gyroscope
would maintain absolute, fixed directions in space. Relativistically, they will not necessarily maintain their
orientations. For example, we've already seen in section \ref{lorentz-three-dim} that there are reasons to
expect that their orientations will change if they are subjected to accelerations that are not all along the
same line. Because relativity is a geometrical theory of spacetime, this difference between the classical
and relativistic behavior must be determinable from purely geometrical considerations, such as the
shape of the world-line. If it depended on something else, then we could conceivably see a disagreement in the
outputs of the two instruments, but this would violate the equivalence principle.

Suppose there were such a discrepancy. That discrepancy would be a physically measurable property of the
space\-time region through which the two gyroscopes had been transported. The effect would have a certain
magnitude and direction, so by collecting enough data we could map it out as vector field covering that region of spacetime.
This field evidently causes material particles to accelerate, since it has an effect on the mechanical gyroscope.
Roughly speaking (the reasoning will be filled
in more rigorously on page \pageref{tensor-universality}),
the fact that this field acts differently on the two gyroscopes is like getting a non-null result from
an E\"{o}tv\"{o}s experiment, and it therefore violates the equivalence principle. 
We conclude that gyroscopes \subfigref{photon-in-cavity-and-gyroscope}{2} and 
\subfigref{photon-in-cavity-and-gyroscope}{3} are equivalent. In other words, there can only be one uniquely
defined notion of direction, and the details of how it is implemented are irrelevant.

<% end_sec %>

<% begin_sec("Boosts causing rotations") %>\label{sec:boosts-causing-rotations}

As a quantitative example, consider the following
thought experiment. Put a gyroscope in a box, and
send the box around the square path shown in figure \figref{thomas-hammers}
at constant speed. The gyroscope defines a local coordinate system, which according to classical
physics would maintain its orientation. At each corner of the square, the box has its velocity vector changed abruptly,
as represented by the hammer. We assume that the hits with the hammer are transmitted to the gyroscope at its center
of mass, so that they do not result in any torque. Nonrelativistically, if the set of gyroscopes travels once around
the square, it should end up at the same place and in the same orientation, so that the coordinate system it defines
is identical with the original one.
<% marg(50) %>
<%
  fig(
    'thomas-hammers',
    %q{Nonrelativistically, the gyroscope should not rotate as long as the forces from the hammer are all transmitted to
              it at its center of mass.}
  )
%>
<% end_marg %>

For notation, let $L(v\hat{\vc{x}})$ indicate the boost along the $x$ axis described by the transformation
on page \pageref{lorentz-three-dim}. This is a transformation that changes to a frame of reference moving in the
\emph{negative} $x$ direction compared to the original frame.
A particle considered to be at rest in the original frame is described in the new frame as moving in the \emph{positive} $x$ direction.
Applying such an $L$ to a vector $\vc{p}$, we calculate $L\vc{p}$, which gives the coordinates of the event as measured in the
new frame. An expression like $ML\vc{p}$ is equivalent by associativity to $M(L\vc{p})$, i.e., $ML$ represents applying $L$ first, and then
$M$.

In this notation, the hammer strikes can be represented by a series of four Lorentz boosts,
\begin{equation*}
  T = L(v\hat{\vc{x}}) \: L(v\hat{\vc{y}}) \: L(-v\hat{\vc{x}}) \: L(-v\hat{\vc{y}})\eqquad,
\end{equation*}
where we assume that the square has negligible size,
so that all four Lorentz boosts act in a way that preserves the origin of the coordinate systems. (We have no convenient way in
our notation $L(\ldots)$ to describe a transformation that does not preserve the origin.) The first
transformation, $L(-v\hat{\vc{y}})$, changes coordinates measured by the original gyroscope-defined frame to new
coordinates measured by the new gyroscope-defined frame, after the box has been accelerated in the positive $y$ direction.
<%
  fig(
    'einstein-notebook',
    %q{%
      A page from one of Einstein's notebooks.
    },
    {
      'width'=>'wide',
      'sidecaption'=>true
    }
  )
%>


The calculation of $T$ is messy, and to be honest, I made a series of mistakes when I tried to crank it out by hand.
Calculations in relativity have a reputation for being like this. Figure \figref{einstein-notebook} shows a page from one of
Einstein's notebooks, written in fountain pen around 1913. At the bottom of the page, he wrote ``zu umstaendlich,''
meaning ``too involved.'' 
Luckily we live in an era in which this sort of thing can be handled by computers. Starting at this point in the
book, I will take appropriate opportunities to demonstrate how to use the
free and open-source computer algebra system Maxima\index{Maxima}\label{introduce-maxima}
to keep complicated calculations manageable. The following Maxima program calculates a particular element of the matrix
$T$.\label{thomas-maxima}
% --------- thomas3.mac -------------
\begin{listing}{1}
/* For convenience, define gamma in terms of v: */
gamma:1/sqrt(1-v*v);
/* Define Lx as L(x-hat), Lmx as L(-x-hat), etc.: */
Lx:matrix([gamma,   gamma*v,  0],
         [gamma*v,  gamma,    0],
         [0,        0,        1]);
Ly:matrix([gamma,   0,        gamma*v],
         [0,        1,        0],
         [gamma*v,  0,        gamma]);
Lmx:matrix([gamma,  -gamma*v, 0],
         [-gamma*v, gamma,    0],
         [0,        0,        1]);
Lmy:matrix([gamma,  0,        -gamma*v],
         [0,        1,        0],
         [-gamma*v, 0,        gamma]);
/* Calculate the product of the four matrices: */
T:Lx.Ly.Lmx.Lmy;
/* Define a column vector along the x axis: */
P:matrix([0],[1],[0]);
/* Find the result of T acting on this vector,
   expressed as a Taylor series to second order in v: */
taylor(T.P,v,0,2);
\end{listing}
Statements are terminated by semicolons, and comments are written like \verb@/* ... */@
On line 2, we see a symbolic definition of the symbol \verb@gamma@ in terms of the symbol \verb@v@. The colon
means ``is defined as.''
Line 2 does not mean, as it would in most programming languages, to take a stored numerical value of $v$ and use it to calculate a numerical
value of $\gamma$. In fact, $v$ does not have a numerical value defined at this point, nor will it ever have a numerical value defined
for it throughout this program. Line 2 simply means that whenever Maxima encounters the symbol \verb@gamma@, it should take it
as an abbreviation for the symbol \verb@1/sqrt(1-v*v)@. Lines 5-16 define some $3\times3$ matrices that represent the $L$ transformations.
The basis is $\hat{\vc{t}}$, $\hat{\vc{x}}$, $\hat{\vc{y}}$.
Line 18 calculates the product of the four matrices; the dots represent matrix multiplication.
Line 23 defines a vector along the $x$ axis, expressed as a column matrix (three rows of one column each)
so that Maxima will know how to operate on it using matrix multiplication by $T$.

Finally line 26 outputs\footnote{I've omitted some output generated automatically from the earlier steps in the
computation. The (\%o9) indicates that this is Maxima's output from the ninth and final step.} the result of $T$ acting on P:
\begin{listing}{19}
                               [  0 + . . .   ]
                               [              ]
(%o9)/T/                       [  1 + . . .   ]
                               [              ]
                               [    2         ]
                               [ - v  + . . . ]
\end{listing}
In other words,
\begin{equation*}
  T\left(\begin{array}{c}0 \\ 1 \\ 0\end{array}\right) = \left(\begin{array}{c}0 \\ 1 \\ -v^2\end{array}\right) + \ldots\eqquad,
\end{equation*}
where $\ldots$ represents higher-order terms in $v$.
Suppose that we use the initial frame of reference, before $T$ is applied, to determine that
a particular reference point, such as a distant star, is along the $x$ axis.
Applying $T$, we get a new vector $T\zu{P}$, which we find has
a nonvanishing $y$ component approximately equal to $-v^2$. This result is entirely unexpected classically.
It tells us that the gyroscope, rather than maintaining its original orientation as it
would have done classically, has rotated slightly. It has precessed in the counterclockwise
direction in the $x-y$ plane, so that the direction to the star, as measured in the
coordinate system defined by the gyroscope, appears to have rotated clockwise.
As the box moved clockwise around the square, the gyroscope has apparently rotated by
a counterclockwise angle $\chi\approx v^2$ about the $z$ axis.
We can see that this is a purely relativistic effect, since for
$v \ll 1$ the effect is small. For historical reasons discussed in section \ref{sec:thomas-precession}, this
phenomenon is referred to as the Thomas precession.

The particular features of this square geometry are not necessary. I chose them so that (1) the boosts
would be along the Cartesian axes, so that we would be able to write them down easily; (2) it is clear that the effect
doesn't arise from any asymmetric treatment of the spatial axes; and (3) the change in the orientation of the gyroscope
can be measured at the same point in space, e.g., by comparing it with a twin gyroscope that stays at home. In general:
\begin{itemize}
\item[] A gyroscope transported around a closed loop in flat spacetime changes its orientation compared with
             one that is not accelerated.
\item[] This is a purely relativistic effect, since a Newtonian gyroscope does not change its axis of rotation
       unless subjected to a torque; if the boosts are accomplished by forces that act at the gyroscope's center of mass,
       then there is no nonrelativistic explanation for the effect.
\item[] The effect can occur in the absence of any gravitational fields. That is, this is a phenomenon of special relativity.
\item[] The composition of two or more Lorentz boosts along different axes is not equivalent to a single boost; it is
             equivalent to a boost plus a spatial rotation.
\item[] Lorentz boosts do not commute, i.e., it makes a difference what order we perform them in.
         Even if there is almost no time lag between the first boost and the second, the order of the boosts matters.
         If we had applied the boosts in the opposite order, the handedness of the effect would have been reversed.
\end{itemize}

Self-check: If Lorentz boosts \emph{did} commute, what would be the consequences
for the expression $L(v\hat{\vc{x}}) \: L(v\hat{\vc{y}}) \: L(-v\hat{\vc{x}}) \: L(-v\hat{\vc{y}})$?

<% begin_sec("The velocity disk") %>
Figure \figref{velocity-disk} shows a useful way of visualizing the combined effects of boosts and
rotations in 2+1 dimensions.
The disk depicts all
possible states of motion relative to some arbitrarily chosen frame of reference. Lack of motion is represented by the point at the
center. A point at distance $v$ from the center represents motion at velocity $v$ in a particular direction in the $x-y$ plane.
By drawing little axes at a particular point, we can represent a particular frame of reference: the frame is in motion at
some velocity, with its own $x$ and $y$ axes are oriented in a particular way.
<% marg(70) %>
<%
  fig(
    'velocity-disk',
    %q{The velocity disk.}
  )
%>
\spacebetweenfigs
<%
  fig(
    'velocity-disk-accel',
    %q{Two excursions in a rocket-ship: one along the $y$ axis and one along $x$.}
  )
%>
<% end_marg %>

It turns out to be easier to understand the qualitative behavior of our mysterious rotations if we switch from the low-velocity limit
to the contrary limit of ultrarelativistic velocities.
Suppose we have a rocket-ship with an inertial navigation system consisting of two gyroscopes at right angles to one another.
We first accelerate the ship in the $y$ direction, and the acceleration is steady 
in the sense that it feels constant to observers
aboard the ship. Since it is rapidities, not velocities, that add linearly, this means that as an observer aboard the ship reads clock
times $\tau_1$, $\tau_2$, \ldots, all separated by equal intervals $\Delta\tau$, the ship's rapidity changes at a constant
rate, $\eta_1$, $\eta_2$, \ldots.
This results in a series of frames of reference that appear closer and closer together on the diagram as the ship approaches the speed of light,
at the edge of the disk. We can start over from the center again and repeat the whole process along the $x$ axis, resulting in a
similar succession of frames. In both cases, the boosts are being applied along a single line, so that there is no rotation of
the $x$ and $y$ axes.

Now suppose that the ship were to accelerate along a route like the one shown in figure \figref{velocity-disk-loop-question}.
It first accelerates along the $y$ axis at a constant
rate (again, as judged by its own sensors), until its velocity is very close to the speed of light, A. It then accelerates,
again at a self-perceived constant rate and with thrust in a fixed direction as judged by its own gyroscopes, until it is moving at the
same ultrarelativistic speed in the $x$ direction, B. Finally, it decelerates in the $x$ direction until it is again at rest, O.
This motion traces out a clockwise loop on the velocity disk. The motion in space is also clockwise.
<% marg(40) %>
<%
  fig(
    'velocity-disk-loop-question',
    %q{A round-trip involving ultrarelativistic velocities. All three legs are at constant acceleration.}
  )
%>
<% end_marg %>

We might naively think that the middle leg of the trip, from A to B, would be a straight line on the velocity disk, but this can't be the case.
First, we know that non-collinear boosts cause rotations. Traveling around a clockwise path causes counterclockwise rotation, and vice-versa.
Therefore an observer in the rest frame O sees the ship (and its gyroscopes)
as rotating as it moves from A to B. The ship's trajectory through space is clockwise, so according to O the ship rotates counterclockwise as it goes
A to B.
The ship is always firing its engines in a fixed direction as judged by its gyroscopes, but according to O the ship is rotating counterclockwise,
its thrust is progressively rotating counterclockwise, and therefore its trajectory turns counterclockwise. We conclude that leg AB
on the velocity disk is concave, rather than being a straight-line hypotenuse of a triangle OAB.

We can also determine, by the following argument, that leg AB is perpendicular to the edge of the disk where it touches the edge of the disk.
In the transformation from frame A to frame O, $y$ coordinates are dilated by a factor of $\gamma$, which approaches infinity in the limit
we're presently considering. Observers aboard the rocket-ship, occupying frame A, believe that their task is to fire the rocket's engines
at an angle of 45 degrees with respect to the $y$ axis, so as to eliminate their velocity with respect to the origin, and simultaneously
add an equal amount of velocity in the $x$ direction. This 45-degree angle in frame A, however, is not a 45-degree angle in frame O.
From the stern of the ship to its bow we have displacements $\Delta x$ and $\Delta y$, and in the transformation from A to O, $\Delta y$
is magnified almost infinitely. As perceived in frame O, the ship's orientation is almost exactly antiparallel to the $y$ axis.\footnote{Although
we will not need any more than this for the purposes of our present analysis, a
longer and more detailed discussion by Rhodes and Semon, \url{www.bates.edu/~msemon/RhodesSemonFinal.pdf}, Am. J. Phys. 72(7)2004, shows that
this type of inertially guided, constant-thrust motion is always represented on the velocity disk by
an arc of a circle that is perpendicular to the disk at its edge. (We consider a diameter of the disk to be
the limiting case of a circle with infinite radius.)}
<% marg(50) %>
<%
  fig(
    'velocity-disk-loop-filled-in',
    %q{In the limit where A and B are ultrarelativistic velocities, leg AB is perpendicular to the edge of the velocity disk.
            The result is that the $x-y$ frame determined by the ship's gyroscopes has rotated by 90 degrees by the time it
            gets home.}
  )
%>
<% end_marg %>

As the ship travels from A to B, its orientation (as judged in frame O) changes from $-\hat{\vc{y}}$ to $\hat{\vc{x}}$.
This establishes, in a much more direct fashion, the direction of the Thomas precession: its handedness is contrary to the handedness of the direction of motion.
We can now also see something new about the fundamental reason for the effect. It has to do with the fact that observers in
different states of motion disagree on spatial angles. Similarly, imagine that you are a two-dimensional being who was
told about the existence of a new, third, spatial dimension. You have always believed that the cosine of the angle between
two unit vectors $\vc{u}$ and $\vc{v}$ is given by the vector dot product $u_xv_x+u_yv_y$. If you were allowed to explore
a two-dimensional projection of a three-dimensional scene, e.g., on the flat screen of a television, it would seem to you
as if all the angles had been distorted. You would have no way to interpret the visual conventions of perspective.
But once you had learned about the existence of a $z$ axis, you would realize that these angular distortions were
happening because of rotations out of the $x-y$ plane. Such rotations really conserve the quantity $u_xv_x+u_yv_y+u_zv_z$; only
because you were ignoring the $u_zv_z$ term did it seem that angles were not being preserved. Similarly, the generalization
from three Euclidean spatial dimensions to 3+1-dimensional spacetime means that three-dimensional dot products are no
longer conserved.

<% end_sec %> % The velocity disk.
<% begin_sec("The general low-$v$ limit") %>\label{thomas-low-v-limit}
Let's find the low-$v$ limit of the Thomas precession in general, not just in the highly artificial
special case of $\chi\approx v^2$ for the example involving the four hammer hits.
To generalize to the case of smooth acceleration, we first note that the rate of precession $\der\chi/\der t$ must have the following properties.
\begin{itemize}
\item[] It is odd under a reversal of the direction of motion, $\vc{v}\rightarrow-\vc{v}$. (This corresponds to sending the gyroscope around
              the square in the opposite direction.)
\item[] It is odd under a reversal of the acceleration due to the second boost, $\vc{a}\rightarrow-\vc{a}$.
\item[] It is a rotation about the spatial axis perpendicular to the plane of the $\vc{v}$ and $\vc{a}$ vectors, in the opposite direction compared
              to the handedness of the curving trajectory.
\item[] It is approximately linear in $\vc{v}$ and $\vc{a}$, for small $\vc{v}$ and $\vc{a}$.
\end{itemize}
The only rotationally invariant mathematical operation that has these symmetry properties is the
vector cross  product, so the rate of precession
must be $k\vc{a}\times\vc{v}$, where $k>0$ is nearly independent of
$\vc{v}$ and $\vc{a}$ for small $\vc{v}$ and $\vc{a}$.

To pin down the value of $k$, we need to find a connection between our two results: $\chi\approx v^2$ for the four hammer hits,
and $\der\chi/\der t\approx k\vc{a}\times\vc{v}$ for smooth acceleration. We can do this by considering the physical significance of
areas on the velocity disk. As shown in figure \figref{thomas-as-area}, the rotation $\chi$ due to carrying the velocity around the boundary of a region is
additive when adjacent regions are joined together. We can therefore find $\chi$ for any region by breaking the region down into
elements of area $\der A$ and integrating their contributions $\der\chi$. What is the relationship between $\der A$ and $\der\chi$?
The velocity disk's structure is nonuniform, in the sense that near the edge of the disk, it takes a larger boost to move a small
distance. But we're investigating the low-velocity limit, and in the low-velocity region near the center of the disk, the disk's structure
is approximately uniform. We therefore expect that there is an approximately constant proportionality factor relating $\der A$ and $\der\chi$
at low velocities. The example of the hammer corresponds geometrically to a square with area $v^2$, so we find that this proportionality factor
is unity, $\der A\approx\der\chi$.
<% marg(70) %>
<%
  fig(
    'thomas-as-area',
    %q{If the crack between the two areas is squashed flat, the two pieces of the path on the interior coincide, and
          their contributions to the precession cancel out ($\vc{v}\rightarrow-\vc{v}$, but $\vc{a}\rightarrow +\vc{a}$, 
          so $\vc{a}\times\vc{v}\rightarrow -\vc{a}\times\vc{v}$). Therefore the precession $\chi$ obtained by going
          around the outside is equal to the sum $\chi_1+\chi_2$ of the precessions that would have been obtained by
          going around the two parts.}
  )
%>
<% end_marg %>

% Rhodes and Semon have a metric that for small v's is approximately ds=2dv; so area is 4v2; this seems to lead to k=2, which is inconsistent with Jackson

To relate this to smooth acceleration, consider a particle performing
circular motion with period $T$, which has $|\vc{a}\times\vc{v}|=2\pi v^2/T$.
Over one full period of the motion, we have $\chi=\int k |\vc{a}\times\vc{v}| \der t=2\pi kv^2$, and the
particle's velocity vector traces a circle of area $A=\pi v^2$ on the velocity disk. Equating $A$ and $\chi$, we
find $k=1/2$. The result is that in the limit of low velocities, the rate of rotation is
\begin{equation*}
 \boldsymbol{\Omega} \approx \frac{1}{2}\vc{a}\times\vc{v}\eqquad,
\end{equation*}
where $\boldsymbol{\Omega}$ is the angular velocity vector of the rotation.
In the special case of circular motion, this can be written as $\Omega=(1/2)v^2\omega$, where $\omega=2\pi/T$ is
the angular frequency of the motion.

% This seems to check out with Jackson, p. 546.

<% end_sec %> % The low-velocity limit
<% end_sec %> % Boosts causing rotations


<% begin_sec("An experimental test: Thomas precession in hydrogen") %>\label{sec:thomas-precession}
If we want to see this precession effect in real life, we should look for a system in which both $v$ and $a$ are large.
An atom is such a system.

The Bohr model,\index{Bohr model} introduced in 1913, marked the first quantitatively successful, if
conceptually muddled, description of the atomic energy levels of hydrogen. Continuing to take $c=1$,
the over-all scale of the energies was calculated to be proportional to $m\alpha^2$, where $m$ is the mass of the
electron, and $\alpha=ke^2/\hbar\approx1/137$, known as the fine structure constant,\index{fine structure constant}
is essentially just a unitless way of expressing the coupling constant for electrical forces.
At higher resolution, each excited energy level is found to be split into several sub-levels. The transitions among
these close-lying states are in the millimeter region of the microwave spectrum. The energy scale of this fine structure is
$\sim m\alpha^4$. This is down by a factor of $\alpha^2$ compared to the visible-light transitions,
hence the name of the constant. Uhlenbeck and Goudsmit\index{Uhlenbeck}\index{Goudsmit} showed in 1926 that a splitting on this order of magnitude
was to be expected due to the magnetic
interaction between the proton and the electron's magnetic moment, oriented along its spin. The effect they calculated,
however, was too big by a factor of two. 
<% marg(60) %>
<%
  fig(
    'fine-structure',
    %q{States in hydrogen are labeled with their $\ell$ and $s$ quantum numbers, representing their orbital and spin angular momenta in units of $\hbar$.
            The state with $s=+1/2$ has its spin angular momentum aligned with its orbital angular momentum, while the $s=-1/2$ state
            has the two angular momenta in opposite directions. The direction and order of magnitude of the splitting between the two
            $\ell=1$ states is successfully explained by magnetic interactions with the proton, but the calculated effect is too big by a factor of 2.
            The relativistic Thomas precession cancels out half of the effect.}
  )
%>
<% end_marg %>

The explanation of the mysterious factor of two had in fact been implicit in a 1916 calculation by
Willem de Sitter,\index{de Sitter, Willem} one of the first applications of general relativity. De Sitter
treated the earth-moon system as a gyroscope, and found the precession of its axis of rotation,
which was partly due to the curvature of spacetime and partly due to the type of rotation described earlier
in this section.
The effect on the motion of the moon was noncumulative, and was only about one meter, which was much
too small to be measured at the time. In 1927, however,  Llewellyn Thomas\index{Thomas, Llewellyn}
applied similar reasoning to the hydrogen atom, with the electron's spin vector playing the role of gyroscope.
Since gravity is negligible here, the effect has nothing to do with curvature of spacetime, and Thomas's
effect corresponds purely to the special-relativistic part of de Sitter's result. It is simply the
rotation described above, with $\Omega=(1/2)v^2\omega$. Although Thomas was not the first to calculate it,
the effect is known as Thomas precession.
Since the electron's spin is $\hbar/2$, the energy splitting is $\pm(\hbar/2)\Omega$, depending on whether the
electron's spin is in the same direction as its orbital motion, or in the opposite direction. This is less than the
atom's gross energy scale $\hbar\omega$ by a factor of $v^2/2$, which is $\sim\alpha^2$. The Thomas
precession cancels out half of the magnetic effect, bringing theory in agreement with experiment.

Uhlenbeck later recalled: ``...when I first heard about [the Thomas precession], it seemed unbelievable that a
relativistic effect could give a factor of 2 instead of something of order $v/c$...  Even
the cognoscenti of relativity theory (Einstein included!) were quite surprised.''


<% end_sec %> % An experimental test: Thomas precession in hydrogen
<% end_sec %> % Geometry of Flat Spacetime


<% begin_hw_sec %>

\vfill

<% begin_hw('clock-postulate') %>
Suppose that we don't yet know the exact form of the Lorentz transformation, but we know based on the
Michelson-Morley experiment that the speed of light is the same in all inertial frames, and we've already
determined, e.g., by arguments like those on p.~\pageref{lorentz-three-dim}, that there can be no length contraction
in the direction perpendicular to the motion. We construct a ``light clock,''\index{light clock}
consisting simply of two mirrors facing each other, with a light pulse bouncing back and forth
between them.\\
(a) Suppose this light clock is moving at a constant velocity $v$ in the direction perpendicular
to its own optical arm, which is of length $L$. Use the Pythagorean theorem to prove that the clock
experiences a time dilation given by $\gamma=1/\sqrt{1-v^2}$, thereby fixing the time-time portion of the Lorentz
transformation.\hwendpart
(b) Why is it significant for the interpretation of special relativity that the result from part a is independent
of $L$?\hwendpart
(c) Carry out a similar calculation in the case where the clock moves with constant acceleration $a$
as measured in some inertial frame. Although the result depends on $L$, prove that in the limit of small
$L$, we recover the earlier constant-velocity result, with no explicit dependence on $a$.\hwendpart
\hwsoln

\hwremark{Some authors state a ``clock postulate'' for special relativity, which says that for a clock that is
sufficiently small, the rate at which
it runs depends only on $v$, not $a$ (except in the trivial sense that $v$ and $a$ are related by calculus).
The result of part c shows that the clock ``postulate'' is really
a theorem, not a statement that is logically independent of the other postulates of special relativity.\index{clock ``postulate''} 
Although this argument only applies to a particular family  of light clocks of various sizes,
one can also make any small clock into an acceleration-insensitive clock, by attaching an accelerometer to it
and applying an appropriate correction to compensate for the clock's observed sensitivity to acceleration.
(It's still necessary for the clock to be small, since otherwise the lack of simultaneity in relativity makes
it impossible to describe the whole clock as having a certain acceleration at a certain instant.)
Farley at al.\footnote{Nuovo Cimento 45 (1966) 281} have verified the ``clock postulate'' to within 2\% for
the radioactive decay of muons with $\gamma\sim12$ being accelerated by magnetic fields at 
$5\times10^{18}\ \munit/\sunit^2$.
Some people get confused by this
acceleration-independent property of small clocks and think that it contradicts the equivalence
principle. For a good explanation, see \url{http://math.ucr.edu/home/baez/physics/Relativity/SR/clock.html}.}
<% end_hw %>

\pagebreak

<% begin_hw('mountain-valley') %>
Some of the most conceptually direct tests of relativistic time dilation were carried out by comparing the rates
of twin atomic clocks, one left on a mountaintop for a certain amount of time, the other in a nearby valley 
below.\footnote{L. Briatore and S. Leschiutta, ``Evidence for the earth gravitational shift by direct atomic-time-scale
 comparison,'' Il Nuovo Cimento B, 37B (2): 219 (1977).
Iijima \emph{et al.}, ``An experiment for the potential blue shift at the Norikura Corona Station,''
Annals of the Tokyo Astronomical Observatory, Second Series, Vol. XVII, 2 (1978) 68.}
Unlike the clocks in the Hafele-Keating experiment, these are stationary for almost the entire duration of the experiment,
so any time dilation is purely gravitational, not kinematic. One could object, however, that the clocks are not really
at rest relative to one another, due to the earth's rotation. This is an example of how the distinction between gravitational
and kinematic time dilations is frame-dependent, since the effect \emph{is} purely gravitational in the rotating frame,
where the gravitational field is reduced by the fictitious centrifugal force. Show that, in the non-rotating frame,
the ratio of the kinematic effect to the gravitational one comes out to be $2.8\times10^{-3}$ at the latitude of Tokyo.
This small value indicates that the experiment can be interpreted as a very pure test of the gravitational time dilation effect.
To calculate the effect, you will need to use the fact that, as discussed on p.~\pageref{grav-redshift-as-time-dil},
gravitational redshifts can be interpreted as gravitational time dilations.\hwsoln
<% end_hw %>
<% marg(100) %>
<%
  fig(
    'iijima',
    %q{A graph from the paper by Iijima, showing the time difference between the two clocks. One clock was kept at Mitaka Observatory, at 58 m above sea level.
       The other was moved back and forth between a second observatory, Norikura Corona Station, and the peak of the Norikura volcano, 2876 m above sea level.
       The plateaus on the graph are data from the periods when the clocks were compared side by side at Mitaka. The difference between one plateau and the next
       is the gravitational time dilation accumulated during the period when the mobile clock was at the top of Norikura.}
  )
%>
<% end_marg %>


<% begin_hw('sagnac-area') %>\index{Sagnac effect!proportional to area}
(a) On p.~\pageref{fig:thomas-as-area} (see figure \figref{thomas-as-area}), we showed that the Thomas precession is
proportional to area on the velocity disk. Use a similar argument to show that the Sagnac effect (p.~\pageref{sagnac}) is proportional
to the area enclosed by the loop.\\
(b) Verify this more directly in the special case of a circular loop.\\
(c) Show that a light clock of the type described in problem \ref{hw:clock-postulate} is insensitive to rotation
with constant angular velocity.\\
(d) Connect these results to the commutativity and transitivity assumptions in the
Einstein clock synchronization procedure described on p.~\pageref{einstein-sync-comm-trans}.
\hwsoln
<% end_hw %>


<% begin_hw('speed-of-sound') %>
Example \ref{eg:newtonian-black-hole} on page \pageref{eg:newtonian-black-hole} discusses
relativistic bounds on the properties of matter, using the example of pulling a bucket
out of a black hole. Derive a similar bound by considering the possibility of sending signals
out of the black hole using longitudinal vibrations of a cable, as in the child's telephone made
of two tin cans connected by a piece of string.
\hwremark{Surprisingly subtle issues can arise in such
calculations; see A.Y. Shiekh, Can. J. Phys. 70, 458 (1992). For a quantitative treatment of
a dangling rope in relativity, see Greg Egan, ``The Rindler Horizon,'' \url{http://gregegan.customer.netspace.net.au/SCIENCE/Rindler/RindlerHorizon.html}.}
<% end_hw %>

<% begin_hw('velocity-addition-matrix-taylor') %>
The Maxima program on page \pageref{thomas-maxima} demonstrates how to multiply matrices
and find Taylor series. Apply this technique to the following problem. For successive Lorentz
boosts along the same axis with rapidities $\eta_1$ and $\eta_2$, find the matrix representing
the combined Lorentz transformation, in a Taylor series up to the first nonclassical terms
in each matrix element.
A mixed Taylor series in two variables can be obtained simply by nesting \verb@taylor@
functions. The \verb@taylor@ function will happily work on matrices, not just scalars.
\hwsoln
<% end_hw %>


<% end_hw_sec %>

<% end_chapter %>
